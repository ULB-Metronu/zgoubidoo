

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>zgoubidoo.commands.magnetique &mdash; Zgoubidoo 2020.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> Zgoubidoo
          

          
          </a>

          
            
            
              <div class="version">
                2020.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../news.html">News and announcements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zgoubi.html">Zgoubi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../commands.html">Zgoubi commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contrib.html">Zgoubidoo specialized and contributed commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../input.html">Working with Zgoubi Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../lowlevel.html">Using the Zgoubidoo low-level interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fieldmaps.html">Field maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../physics.html">Physics with Zgoubidoo high-level interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../vis.html">Zgoubidoo’s visualization and plotting module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../utilities.html">Zgoubidoo’s utility modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Zgoubidoo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>zgoubidoo.commands.magnetique</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for zgoubidoo.commands.magnetique</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Zgoubidoo&#39;s interfaces to purefly magnetic Zgoubi commands.</span>

<span class="sd">More details here.</span>
<span class="sd">TODO</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">_np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">_pd</span>
<span class="kn">import</span> <span class="nn">parse</span> <span class="k">as</span> <span class="nn">_parse</span>
<span class="kn">import</span> <span class="nn">lmfit</span>
<span class="kn">from</span> <span class="nn">.particules</span> <span class="kn">import</span> <span class="n">ParticuleType</span> <span class="k">as</span> <span class="n">_ParticuleType</span>
<span class="kn">from</span> <span class="nn">.commands</span> <span class="kn">import</span> <span class="n">CommandType</span> <span class="k">as</span> <span class="n">_CommandType</span>
<span class="kn">from</span> <span class="nn">.actions</span> <span class="kn">import</span> <span class="n">FitType</span> <span class="k">as</span> <span class="n">_FitType</span>
<span class="kn">from</span> <span class="nn">.commands</span> <span class="kn">import</span> <span class="n">Command</span> <span class="k">as</span> <span class="n">_Command</span>
<span class="kn">from</span> <span class="nn">.commands</span> <span class="kn">import</span> <span class="n">Marker</span> <span class="k">as</span> <span class="n">_Marker</span>
<span class="kn">from</span> <span class="nn">.actions</span> <span class="kn">import</span> <span class="n">Fit</span> <span class="k">as</span> <span class="n">_Fit</span>
<span class="kn">from</span> <span class="nn">.actions</span> <span class="kn">import</span> <span class="n">Fit2</span> <span class="k">as</span> <span class="n">_Fit2</span>
<span class="kn">from</span> <span class="nn">.commands</span> <span class="kn">import</span> <span class="n">ZgoubidooException</span> <span class="k">as</span> <span class="n">_ZgoubidooException</span>
<span class="kn">from</span> <span class="nn">.objet</span> <span class="kn">import</span> <span class="n">Objet2</span> <span class="k">as</span> <span class="n">_Objet2</span>
<span class="kn">from</span> <span class="nn">.particules</span> <span class="kn">import</span> <span class="n">Proton</span> <span class="k">as</span> <span class="n">_Proton</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">ureg</span> <span class="k">as</span> <span class="n">_ureg</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">Q_</span> <span class="k">as</span> <span class="n">_Q</span>
<span class="kn">from</span> <span class="nn">..zgoubi</span> <span class="kn">import</span> <span class="n">Zgoubi</span> <span class="k">as</span> <span class="n">_Zgoubi</span>
<span class="kn">from</span> <span class="nn">.patchable</span> <span class="kn">import</span> <span class="n">Patchable</span> <span class="k">as</span> <span class="n">_Patchable</span>
<span class="kn">from</span> <span class="nn">.plotable</span> <span class="kn">import</span> <span class="n">Plotable</span> <span class="k">as</span> <span class="n">_Plotable</span>
<span class="kn">from</span> <span class="nn">..fieldmaps</span> <span class="kn">import</span> <span class="n">FieldMap</span> <span class="k">as</span> <span class="n">_FieldMap</span>
<span class="kn">from</span> <span class="nn">..units</span> <span class="kn">import</span> <span class="n">_cm</span><span class="p">,</span> <span class="n">_radian</span><span class="p">,</span> <span class="n">_kilogauss</span><span class="p">,</span> <span class="n">_degree</span><span class="p">,</span> <span class="n">_ampere</span>
<span class="kn">import</span> <span class="nn">zgoubidoo</span>
<span class="kn">from</span> <span class="nn">georges_core.kinematics</span> <span class="kn">import</span> <span class="n">Kinematics</span> <span class="k">as</span> <span class="n">_Kinematics</span>
<span class="kn">from</span> <span class="nn">georges_core.frame</span> <span class="kn">import</span> <span class="n">Frame</span> <span class="k">as</span> <span class="n">_Frame</span>


<div class="viewcode-block" id="MagnetType"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.MagnetType.html#zgoubidoo.commands.magnetique.MagnetType">[docs]</a><span class="k">class</span> <span class="nc">MagnetType</span><span class="p">(</span><span class="n">_CommandType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Type for magnetic element commands.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="Magnet"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Magnet.html#zgoubidoo.commands.magnetique.Magnet">[docs]</a><span class="k">class</span> <span class="nc">Magnet</span><span class="p">(</span><span class="n">_Command</span><span class="p">,</span> <span class="n">_Patchable</span><span class="p">,</span> <span class="n">_Plotable</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">MagnetType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for all magnetic elements.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;HEIGHT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Height of the magnet (distance between poles), used by plotting functions.&#39;</span><span class="p">),</span>
        <span class="s1">&#39;POLE_WIDTH&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Pole width (used for plotting only).&#39;</span><span class="p">),</span>
        <span class="s1">&#39;PIPE_THICKNESS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Thickness of the pipe, used by plotting functions.&#39;</span><span class="p">),</span>
        <span class="s1">&#39;PIPE_COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="s1">&#39;Color of the pipe, used by plotting functions.&#39;</span><span class="p">),</span>
        <span class="s1">&#39;REFERENCE_FIELD_COMPONENT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;BZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Orientation of the reference field (used by field maps)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;KINEMATICS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;A kinematics object.&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Magnet.post_init"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Magnet.html#zgoubidoo.commands.magnetique.Magnet.post_init">[docs]</a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_FieldMap</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            field_map:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_map</span> <span class="o">=</span> <span class="n">field_map</span>
        <span class="c1"># noinspection PyAttributeOutsideInit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_field_profile_model</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">field_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_FieldMap</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Attach a field map to the element.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_field_map</span>

    <span class="nd">@field_map</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">field_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">_FieldMap</span><span class="p">):</span>
        <span class="c1"># noinspection PyAttributeOutsideInit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_field_map</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">field_profile_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A model for the field profile.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_field_profile_model</span>

<div class="viewcode-block" id="Magnet.process_fit_field_profile"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Magnet.html#zgoubidoo.commands.magnetique.Magnet.process_fit_field_profile">[docs]</a>    <span class="k">def</span> <span class="nf">process_fit_field_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fit</span><span class="p">:</span> <span class="n">lmfit</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ModelResult</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            fit: </span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div></div>


<div class="viewcode-block" id="CartesianMagnetType"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.CartesianMagnetType.html#zgoubidoo.commands.magnetique.CartesianMagnetType">[docs]</a><span class="k">class</span> <span class="nc">CartesianMagnetType</span><span class="p">(</span><span class="n">MagnetType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Type for cartesian magnets.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="CartesianMagnet"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.CartesianMagnet.html#zgoubidoo.commands.magnetique.CartesianMagnet">[docs]</a><span class="k">class</span> <span class="nc">CartesianMagnet</span><span class="p">(</span><span class="n">Magnet</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">CartesianMagnetType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for magnetic elements in cartesian coordinates.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;APERTURE_LEFT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Aperture size of the magnet, left side (used for plotting only).&#39;</span><span class="p">),</span>
        <span class="s1">&#39;APERTURE_RIGHT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Aperture size of the magnet, right side (used for plotting only).&#39;</span><span class="p">),</span>
        <span class="s1">&#39;APERTURE_TOP&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Aperture size of the magnet, top side (used for plotting only).&#39;</span><span class="p">),</span>
        <span class="s1">&#39;APERTURE_BOTTOM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Aperture size of the magnet, bottom side (used for plotting only).&#39;</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;Magnet color for plotting.&#39;</span><span class="p">),</span>
        <span class="s1">&#39;LENGTH_IS_ARC_LENGTH&#39;</span><span class="p">:</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span>

<div class="viewcode-block" id="CartesianMagnet.post_init"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.CartesianMagnet.html#zgoubidoo.commands.magnetique.CartesianMagnet.post_init">[docs]</a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LENGTH_IS_ARC_LENGTH</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">KINEMATICS</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;Arc length conversion requested but KINEMATICS not provided.&quot;</span><span class="p">)</span>
            <span class="n">arc_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XL</span>
            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">B0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">B1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">B1</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">KINEMATICS</span><span class="o">.</span><span class="n">brho</span> <span class="o">/</span> <span class="n">field</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">arc_length</span> <span class="o">/</span> <span class="n">rho</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">XL</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ALE</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">XL</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">x_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">XCE</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">y_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">YCE</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entry_patched</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_Frame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_E</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_offset</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">translate_y</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_offset</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">rotate_z</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_E</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">rotate_z</span><span class="p">(</span>
                    <span class="o">-</span><span class="n">_np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XL</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">B1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">KINEMATICS</span><span class="o">.</span><span class="n">brho</span><span class="p">))</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_Frame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_patched</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_patched</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_E</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit_patched</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_Frame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_S</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XL</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_S</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span><span class="o">.</span><span class="n">rotate_z</span><span class="p">(</span>
                    <span class="o">-</span><span class="n">_np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XL</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">B1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">KINEMATICS</span><span class="o">.</span><span class="n">brho</span><span class="p">))</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span></div>


<div class="viewcode-block" id="PolarMagnetType"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnetType.html#zgoubidoo.commands.magnetique.PolarMagnetType">[docs]</a><span class="k">class</span> <span class="nc">PolarMagnetType</span><span class="p">(</span><span class="n">MagnetType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Type for polar magnets.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="PolarMagnet"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnet.html#zgoubidoo.commands.magnetique.PolarMagnet">[docs]</a><span class="k">class</span> <span class="nc">PolarMagnet</span><span class="p">(</span><span class="n">Magnet</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">PolarMagnetType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for magnetic elements in polar coordinates.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;POLE_WIDTH&#39;</span><span class="p">:</span> <span class="mi">150</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span>
        <span class="s1">&#39;APERTURE_LEFT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Aperture size of the magnet, left side (used for plotting only).&#39;</span><span class="p">),</span>
        <span class="s1">&#39;APERTURE_RIGHT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Aperture size of the magnet, right side (used for plotting only).&#39;</span><span class="p">),</span>
        <span class="s1">&#39;APERTURE_TOP&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Aperture size of the magnet, top side (used for plotting only).&#39;</span><span class="p">),</span>
        <span class="s1">&#39;APERTURE_BOTTOM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Aperture size of the magnet, bottom side (used for plotting only).&#39;</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optionally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span>

<div class="viewcode-block" id="PolarMagnet.adjust_tracks_variables"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnet.html#zgoubidoo.commands.magnetique.PolarMagnet.adjust_tracks_variables">[docs]</a>    <span class="k">def</span> <span class="nf">adjust_tracks_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tracks</span><span class="p">:</span> <span class="n">_pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">]</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;ANGLE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">angles</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;R0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Yo&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;SREF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">angles</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_s</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;YT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">radius</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;YT0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Yo&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">radius</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;ZT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;ZT0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Zo&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;X0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Yo&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">-</span> <span class="n">radius</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;Y0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Yo&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">-</span> <span class="n">radius</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">angular_opening</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">reference_angles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">_Q</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ACENT</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entrance_efb</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_E</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit_efb</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_S</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">angular_opening</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;rad&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entry_patched</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_Frame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">translate_y</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RE</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">rotate_z</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TE</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_Frame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_center</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_patched</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_patched</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_center</span><span class="o">.</span><span class="n">translate_y</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_center</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_Frame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span><span class="o">.</span><span class="n">translate_y</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span><span class="o">.</span><span class="n">rotate_z</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">angular_opening</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit_patched</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_Frame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span><span class="o">.</span><span class="n">translate_y</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">RS</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span><span class="o">.</span><span class="n">rotate_z</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TS</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span>

<div class="viewcode-block" id="PolarMagnet.drift_length_from_polar"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnet.html#zgoubidoo.commands.magnetique.PolarMagnet.drift_length_from_polar">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">drift_length_from_polar</span><span class="p">(</span><span class="n">radius</span><span class="p">:</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">magnet_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">poles_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            radius: the reference radius of the magnet</span>
<span class="sd">            magnet_angle: total angular opening of the magnet (i.e. of the field-map)</span>
<span class="sd">            poles_angle: angular opening of the poles</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">tan</span><span class="p">(((</span><span class="n">magnet_angle</span> <span class="o">-</span> <span class="n">poles_angle</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;radian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolarMagnet.efb_offset_from_polar"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnet.html#zgoubidoo.commands.magnetique.PolarMagnet.efb_offset_from_polar">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">efb_offset_from_polar</span><span class="p">(</span><span class="n">radius</span><span class="p">:</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">magnet_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">poles_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            radius: the reference radius of the magnet</span>
<span class="sd">            magnet_angle: total angular opening of the magnet (i.e. of the field-map)</span>
<span class="sd">            poles_angle: angular opening of the poles</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">radius</span> <span class="o">/</span> <span class="n">_np</span><span class="o">.</span><span class="n">cos</span><span class="p">(((</span><span class="n">magnet_angle</span> <span class="o">-</span> <span class="n">poles_angle</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;radian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolarMagnet.efb_angle_from_polar"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnet.html#zgoubidoo.commands.magnetique.PolarMagnet.efb_angle_from_polar">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">efb_angle_from_polar</span><span class="p">(</span><span class="n">magnet_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">poles_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            magnet_angle: total angular opening of the magnet (i.e. of the field-map)</span>
<span class="sd">            poles_angle: angular opening of the poles</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">magnet_angle</span> <span class="o">-</span> <span class="n">poles_angle</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entry_wedge_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">_Q</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">THETA_E</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit_wedge_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">_Q</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">THETA_S</span><span class="p">]</span></div>


<div class="viewcode-block" id="PolarMultiMagnet"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMultiMagnet.html#zgoubidoo.commands.magnetique.PolarMultiMagnet">[docs]</a><span class="k">class</span> <span class="nc">PolarMultiMagnet</span><span class="p">(</span><span class="n">PolarMagnet</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">reference_angles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">_Q</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ACN</span></div>


<div class="viewcode-block" id="AGSMainMagnet"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.AGSMainMagnet.html#zgoubidoo.commands.magnetique.AGSMainMagnet">[docs]</a><span class="k">class</span> <span class="nc">AGSMainMagnet</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;AGS main magnet.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    The AGS main magnet is a combined function dipole with straight axis (lines of constant field are straight lines).</span>
<span class="sd">    The field computation routines for AGSMM are the same as for MULTIPOL (details in section 1.3.7, page 26),</span>
<span class="sd">    however AGSMM has the following four particularities :</span>

<span class="sd">    * There are only three multipole components present in AGSMM : dipole, quadrupole and sextupole.</span>

<span class="sd">    * The dipole field B0 is drawn from the reference rigidity, Bρref ,</span>
<span class="sd">      and follows the latter so to preserve :math:`\rho = B\rho_{ref}/B0` and the orbit deviation L/ρ. In particular,</span>

<span class="sd">            * in the absence of acceleration, Bρref ≡ BORO, with BORO the quantity appearing in the object definition</span>
<span class="sd">              using [MC]OBJET,</span>

<span class="sd">            * in presence of acceleration using CAVITE, Bρref is changed to BORO×Dref at each passage in the cavity,</span>
<span class="sd">              with Dref the relative synchronous momentum increase, a quantity that zgoubi updates at cavity traversal.</span>

<span class="sd">    * The field indices, quadrupole K1 and sextupole K2, are derived from the reference rigidity, Bρref ,</span>
<span class="sd">      via momentum-dependent polynomials, taken from Ref. [39], and following in that the methods found</span>
<span class="sd">      in the MAD model of the AGS [40].</span>

<span class="sd">    * The AGS main dipole has back-leg windings, used for instance for injection and extraction orbit bumps.</span>

<span class="sd">    The number of winding turns and the number of ampere-turns are part of the data in the input data list.</span>
<span class="sd">    The intensity in the windings is accounted for in the conversion from total ampere-turns in the magnet to momentum</span>
<span class="sd">    and then to magnetic field.</span>
<span class="sd">    Note : A consequence of items 2 and 3 is that no field value is required in defining the AGS main magnets</span>
<span class="sd">    in the zgoubi.dat input data list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;AGSMM&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Print field and coordinates along trajectories&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;MOD&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Type of dipole magnet&quot;</span><span class="p">),</span>
        <span class="s1">&#39;dL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;UNUSED&quot;</span><span class="p">),</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Radius of the pole tips&#39;</span><span class="p">),</span>
        <span class="s1">&#39;dB1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Relative error on dipole component&#39;</span><span class="p">),</span>
        <span class="s1">&#39;dB2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Relative error on quadrupole component&#39;</span><span class="p">),</span>
        <span class="s1">&#39;dB3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Relative error on sextupole component&#39;</span><span class="p">),</span>
        <span class="s1">&#39;NBLW&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Number of back-leg windings&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;WMOD&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Back-leg winding model&#39;</span><span class="p">,),</span>
        <span class="s1">&#39;NW&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Number of windings&#39;</span><span class="p">,),</span>
        <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">ampere</span><span class="p">,</span> <span class="s1">&#39;Current of windings&#39;</span><span class="p">,),</span>
        <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face integration zone for the fringe field&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face fringe field extent&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span>
        <span class="s1">&#39;E2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Quadrupole fringe field extent&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span>
        <span class="s1">&#39;E3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Sextupole fringe field extent&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span>
        <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;UNUSED&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face integration zone for the fringe field&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face fringe field extent&#39;</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span>
        <span class="s1">&#39;S2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Quadrupole fringe field extent&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;S3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Sextupole fringe field extent&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;UNUSED&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">52</span><span class="p">),</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="p">),</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">54</span><span class="p">),</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">),</span>
        <span class="s1">&#39;R1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;Skew angle of field component R1&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;Skew angle of field component R2&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;R3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;Skew angle of field component R3&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Misalignment type&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;x offset&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;y offset&#39;</span><span class="p">,</span> <span class="mi">82</span><span class="p">),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;misalignment rotation&#39;</span><span class="p">,</span> <span class="mi">83</span><span class="p">),</span>
        <span class="s1">&#39;XS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;X shift&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">),</span>
        <span class="s1">&#39;YS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Y shift&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">),</span>
        <span class="s1">&#39;ZR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Z rotation&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">),</span>
        <span class="s1">&#39;ZS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Z shift&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">),</span>
        <span class="s1">&#39;YR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Y rotation&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;#FF0000&#39;</span><span class="p">,</span> <span class="s1">&#39;Magnet color for plotting.&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_E</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LAM_E</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_E</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_S</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LAM_S</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_S</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">MOD</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">dL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">dB1</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">dB2</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">dB3</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NBLW</span><span class="si">}</span><span class="s2">[.</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">WMOD</span><span class="si">}</span><span class="s2">]</span>
<span class="s2">             &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">NBLW</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NW</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_ampere</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">X_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">E2</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">E3</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCE</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">X_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">S2</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">S3</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R3</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;   </span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">YS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ZR</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ZS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">YR</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="AGSQuadrupole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.AGSQuadrupole.html#zgoubidoo.commands.magnetique.AGSQuadrupole">[docs]</a><span class="k">class</span> <span class="nc">AGSQuadrupole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;AGS quadrupole.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    The AGS quadrupoles are regular quadrupoles. The simulation of ``AGSQUAD`` uses the same field modelling as</span>
<span class="sd">    ``MULTIPOL``, section 1.3.7, page 25. However amperes are provided as input to ``AGSQUAD`` rather than fields,</span>
<span class="sd">    the reason being that some of the AGS quadrupoles have two superimposed coil circuits, with separate power</span>
<span class="sd">    supplies. It has been dealt with this particularity by allowing for an additional set of multi- pole data in</span>
<span class="sd">    ``AGSQUAD``, compared to ``MULTIPOL``.</span>
<span class="sd">    The field in ``AGSQUAD`` is computed using transfer functions from the ampere-turns in the coils to magnetic</span>
<span class="sd">    field that account for the non-linearity of the magnetic permeability [33].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;AGSQUAD&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Print field and coordinates along trajectories&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Magnet length (straight reference frame)&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Radius of the pole tips&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="s1">&#39;IW1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">ampere</span><span class="p">,</span> <span class="s1">&#39;Current in windings&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;IW2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">ampere</span><span class="p">,</span> <span class="s1">&#39;Current in windings&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
        <span class="s1">&#39;IW3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">ampere</span><span class="p">,</span> <span class="s1">&#39;Current in windings&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
        <span class="s1">&#39;dIW1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Relative error on current&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
        <span class="s1">&#39;dIW2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Relative error on current&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
        <span class="s1">&#39;dIW3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Relative error on current&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
        <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face integration zone for the fringe field&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face fringe field extent&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;UNUSED&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face integration zone for the fringe field&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face fringe field extent&#39;</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span>
        <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;UNUSED&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">52</span><span class="p">),</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="p">),</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">54</span><span class="p">),</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">),</span>
        <span class="s1">&#39;R1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;Roll angle&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Misalignment type&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;x offset&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;y offset&#39;</span><span class="p">,</span> <span class="mi">82</span><span class="p">),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;misalignment rotation&#39;</span><span class="p">,</span> <span class="mi">83</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;#FF0000&#39;</span><span class="p">,</span> <span class="s1">&#39;Magnet color for plotting.&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_E</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LAM_E</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_E</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_S</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LAM_S</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_S</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_ampere</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">IW1</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_ampere</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">IW2</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_ampere</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">IW3</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">dIW1</span> <span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">dIW1</span> <span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">dIW2</span> <span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">X_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCE</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">X_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Aimant"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Aimant.html#zgoubidoo.commands.magnetique.Aimant">[docs]</a><span class="k">class</span> <span class="nc">Aimant</span><span class="p">(</span><span class="n">PolarMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generation of dipole mid-plane 2-D map, polar frame.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;AIMANT&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;NFACE&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;IC&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># 1, 2: print field map</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># 1, 2: print field and coordinates on trajectores</span>
        <span class="s1">&#39;IAMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;IRMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;ACENT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RMIN&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_E&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_S&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;LAM_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;RM3&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NBS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DELTAB&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;IORDRE&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DP&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIM_R1&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_R2&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_THETA1&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_THETA2&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_LAMBDA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_GAMMA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_ALPHA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_BETA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_MU&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NFACE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error : Zgoubido does not support NFACE = </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NFACE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NFACE</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IC</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IAMAX</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IRMAX</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">G</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">AT</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">ACENT</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RM</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RMIN</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RMAX</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XI_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCE</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XI_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NFACE</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XI_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCL</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R1_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U1_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U2_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R2_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RM3</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NBS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NBS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">DELTAB</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NBS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">DELTAB</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NBS</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

            <span class="n">shim_r1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R1</span><span class="p">)</span>
            <span class="n">shim_r2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R2</span><span class="p">)</span>
            <span class="n">shim_theta1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA1</span><span class="p">)</span>
            <span class="n">shim_theta2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA2</span><span class="p">)</span>
            <span class="n">shim_lambda</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_LAMBDA</span><span class="p">)</span>
            <span class="n">shim_gamma</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_GAMMA</span><span class="p">)</span>
            <span class="n">shim_alpha</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_ALPHA</span><span class="p">)</span>
            <span class="n">shim_beta</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_BETA</span><span class="p">)</span>
            <span class="n">shim_mu</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_MU</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">shim_r1</span> \
                    <span class="o">==</span> <span class="n">shim_r2</span> \
                    <span class="o">==</span> <span class="n">shim_theta1</span> \
                    <span class="o">==</span> <span class="n">shim_theta2</span> \
                    <span class="o">==</span> <span class="n">shim_lambda</span> \
                    <span class="o">==</span> <span class="n">shim_gamma</span> \
                    <span class="o">==</span> <span class="n">shim_alpha</span> \
                    <span class="o">==</span> <span class="n">shim_beta</span> \
                    <span class="o">==</span> <span class="n">shim_mu</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R1</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_R2</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA1</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_LAMBDA</span><span class="p">):</span>
                    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">l</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                        &quot;&quot;&quot;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">GAMMA</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">MU</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">BETA</span><span class="p">):</span>
                    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                                       </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">l</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                                       &quot;&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s1">&#39;Error : The shim parameters lists must have the same lenghts&#39;</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IORDRE</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">TE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RS</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">TS</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">DP</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Bend"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Bend.html#zgoubidoo.commands.magnetique.Bend">[docs]</a><span class="k">class</span> <span class="nc">Bend</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Bending magnet, Cartesian frame.</span>

<span class="sd">    .. note:: This is mostly a **sector bend** element defined in cartesian coordinates.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;BEND&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Print field and coordinates along trajectories&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Magnet length (straight reference frame)&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;SK&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s2">&quot;Skew angle&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="s1">&#39;B1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s2">&quot;Dipole field&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Integration zone extension (entrance face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Fringe field extension (entrance face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;W_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s2">&quot;Wedge angle (entrance face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Entrance fringe field coefficient C0&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Entrance fringe field coefficient C1&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Entrance fringe field coefficient C2&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Entrance fringe field coefficient C3&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Entrance fringe field coefficient C4&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Entrance fringe field coefficient C5&#39;</span><span class="p">),</span>
        <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Integration zone extension (exit face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Fringe field extension (exit face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;W_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s2">&quot;Wedge angle (exit face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Exit fringe field coefficient C0&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Exit fringe field coefficient C1&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Exit fringe field coefficient C2&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Exit fringe field coefficient C3&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Exit fringe field coefficient C4&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Exit fringe field coefficient C5&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Integration step&quot;</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Alignment parameter&quot;</span><span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="s1">&#39;#4169E1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;LENGTH_IS_ARC_LENGTH&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Bend.post_init"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Bend.html#zgoubidoo.commands.magnetique.Bend.post_init">[docs]</a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LAM_S</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_S</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LAM_E</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_E</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="p">)</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XL</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">SK</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;radian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">B1</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">X_E</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_E</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">W_E</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;radian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">X_S</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_S</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">W_S</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;radian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="p">)</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Decapole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Decapole.html#zgoubidoo.commands.magnetique.Decapole">[docs]</a><span class="k">class</span> <span class="nc">Decapole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Decapole magnet.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    The meaning of parameters for ``DECAPOLE`` is the same as for ``QUADRUPO``.</span>
<span class="sd">    In fringe field regions the magnetic field :math:`\vec{B}(X, Y, Z)` and its derivatives up to fourth order are</span>
<span class="sd">    derived from the scalar potential expressed to the 5th order in Y and Z</span>

<span class="sd">    .. math::</span>

<span class="sd">        V (X, Y,Z) = G(X) (Y^4Z - 2Y^2Z^3 + \frac{Z^5}{5})</span>

<span class="sd">    with :math:`G0=\frac{B_0}{R_0^4}`</span>
<span class="sd">    The modelling of the fringe field form factor G(X) is described under ``QUADRUPO``, p. 128.</span>
<span class="sd">    Outside fringe field regions, or everywhere in sharp edge decapole (:math:`λ_E = λ_S = 0`) , :math:`\vec{B}(X, Y, Z)` in the</span>
<span class="sd">    magnet is given by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \begin{align}</span>
<span class="sd">            B_X &amp;= 0 \\</span>
<span class="sd">            B_Y &amp;= 4G_0(Y^2 − Z^2)YZ \\</span>
<span class="sd">            B_Z &amp;= G_0(Y^4 − 6Y^2Z^2 + Z^4)</span>
<span class="sd">        \end{align}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DECAPOLE&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Print field and coordinates along trajectories&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Magnet length (straight reference frame)&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Radius of the pole tips&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tips&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face integration zone for the fringe field&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face fringe field extent&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;UNUSED&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face integration zone for the fringe field&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face fringe field extent&#39;</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span>
        <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;UNUSED&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">52</span><span class="p">),</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="p">),</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">54</span><span class="p">),</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Misalignment type&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;x offset&#39;</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;y offset&#39;</span><span class="p">,</span> <span class="mi">72</span><span class="p">),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;misalignment rotation&#39;</span><span class="p">,</span> <span class="mi">73</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;#FF0000&#39;</span><span class="p">,</span> <span class="s1">&#39;Magnet color for plotting.&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IL</span><span class="p">)</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">B0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAM_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C1</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C2</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C3</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C4</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C5</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAM_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C1</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C2</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C3</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C4</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">C5</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span><span class="p">)</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Dipole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Dipole.html#zgoubidoo.commands.magnetique.Dipole">[docs]</a><span class="k">class</span> <span class="nc">Dipole</span><span class="p">(</span><span class="n">PolarMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dipole magnet, polar frame.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    ``DIPOLE`` provides a model of a dipole field, possibly with transverse field indices. The field along a particle</span>
<span class="sd">    trajectory is computed as the particle motion proceeds, straightforwardly from the dipole geometrical boundaries.</span>
<span class="sd">    Field simulation in ``DIPOLE`` is the same as used in ``DIPOLE-M`` and ``AIMANT`` for computing a field map;</span>
<span class="sd">    the essential difference in ``DIPOLE`` is in its skipping that intermediate stage of field map generation found in</span>
<span class="sd">    ``DIPOLE-M`` and ``AIMANT``.</span>

<span class="sd">    ``DIPOLE`` has a version, ``DIPOLES``, that allows overlapping of fringe fields in a configuration of neighboring</span>
<span class="sd">    magnets.</span>

<span class="sd">    The dimensioning of the magnet is defined by (Fig. 11, p. 82):</span>

<span class="sd">        - AT : total angular aperture</span>
<span class="sd">        - RM : mean radius used for the positioning of field boundaries</span>

<span class="sd">    The 2 or 3 effective field boundaries (EFB), from which the dipole field is drawn, are defined from geometric</span>
<span class="sd">    boundaries, the shape and position of which are determined by the following parameters:</span>

<span class="sd">        - ACENT: arbitrary inner angle, used for EFB’s positioning;</span>
<span class="sd">        - ω: azimuth of an EFB with respect to ACENT;</span>
<span class="sd">        - θ: angle of an EFB with respect to its azimuth (wedge angle) : radius of curvature of an EFB;</span>
<span class="sd">        - R1, R2 U1, U2: extent of the linear part of an EFB.</span>

<span class="sd">    The magnetic field is calculated in polar coordinates. At any position (R, θ) along the particle trajectory the</span>
<span class="sd">    value of the vertical component of the mid-plane field is calculated using</span>

<span class="sd">    R−RM􏰖 􏰕R−RM􏰖2 􏰕R−RM􏰖3􏰛 BZ(R,θ)=F(R,θ)∗B0∗ 1+N∗ RM +B∗ RM +G∗ RM (4.4.8)</span>

<span class="sd">    where N, B and G are respectively the first, second and third order field indices and F(R,θ) is the fringe field</span>
<span class="sd">    coefficient (it determines the “flutter” in periodic structures).</span>

<span class="sd">    Calculation of the Fringe Field Coefficient</span>

<span class="sd">    With each EFB a realistic extent of the fringe field, λ (normally equal to the gap size), is associated and a</span>
<span class="sd">    fringe field coefficient F is calculated. In the following λ stands for either λE (Entrance), λS (Exit)</span>
<span class="sd">    or λL (Lateral EFB).</span>

<span class="sd">    F is an exponential type fringe field (Fig. 12, p. 84) given by [34] F=1</span>
<span class="sd">    1+expP(s) wherein s is the distance to the EFB and depends on (R, θ), and</span>
<span class="sd">    P(s)=C0 +C1􏰓s􏰔+C2􏰓s􏰔2 +C3􏰓s􏰔3 +C4􏰓s􏰔4 +C5􏰓s􏰔5 λλλλλ</span>
<span class="sd">    It is also possible to simulate a shift of the EFB, by giving a non zero value to the parameter shift. s is then changed to s−shift in the previous equation. This allows small variations of the magnetic length.</span>
<span class="sd">    Let FE (respectively FS , FL) be the fringe field coefficient attached to the entrance (respectively exit, lateral) EFB. At any position on a trajectory the resulting value of the fringe field coefficient (eq. 4.4.8) is</span>

<span class="sd">    102 4 DESCRIPTION OF THE AVAILABLE PROCEDURES</span>
<span class="sd">    F(R,θ)=FE ∗FS ∗FL In particular, FL ≡ 1 if no lateral EFB is requested.</span>
<span class="sd">    Calculation of the Mid-plane Field and Derivatives</span>
<span class="sd">    BZ (R, θ) in Eq. 4.4.8 is computed at the n × n nodes (n = 3 or 5 in practice) of a “flying” interpolation grid in the median plane centered on the projection m0 of the actual particle position M0 as schemed in Fig. 20. A polynomial interpolation is involved, of the form</span>
<span class="sd">    BZ(R,θ)=A00 +A10θ+A01R+A20θ2 +A11θR+A02R2 that yields the requested derivatives, using</span>
<span class="sd">    Akl = 1 ∂k+lBZ k!l! ∂θk∂rl</span>
<span class="sd">    Note that, the source code contains the explicit analytical expressions of the coefficients Akl solutions of the normal equations, so that the operation is not CPU time consuming.</span>
<span class="sd">    B2</span>
<span class="sd">    interpolation</span>
<span class="sd">    grid δ s particle</span>
<span class="sd">    trajectory B1mm1 B3</span>
<span class="sd">    0</span>
<span class="sd">    Figure 20: Interpolation method. m0 and m1 are the projections in the median plane of particle positions M0 and M1 and separated by δs, projection of the integration step.</span>
<span class="sd">    Extrapolation Off Median Plane</span>
<span class="sd">    From the vertical field B⃗ and derivatives in the median plane, first a transformation from polar to Cartesian coordinates is performed, following eqs (1.4.9 or 1.4.10), then, extrapolation off median plane is performed by means of Taylor expansions, following the procedure described in section 1.3.3.</span>

<span class="sd">    .. rubric:: Zgoubidoo usage and example</span>

<span class="sd">    &gt;&gt;&gt; m = Dipole()</span>
<span class="sd">    &gt;&gt;&gt; m.fit()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DIPOLE&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Total angular extent of the dipole (positive value in all cases)&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Reference radius&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="s1">&#39;ACENT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Azimuth for positioning of EFBs&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Reference field&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Field index (radial quadrupolar)&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
        <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Field index (radial sextupolar)&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
        <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Field index (radial octupolar)&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance fringe field extent (normally ≃ gap size)&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span>
        <span class="s1">&#39;THETA_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Entrance face wedge angle&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;R1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB radius&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;U1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span>
        <span class="s1">&#39;U2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span>
        <span class="s1">&#39;R2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB radius&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit fringe field extent (normally ≃ gap size)&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span>
        <span class="s1">&#39;THETA_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Exit face wedge angle&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
        <span class="s1">&#39;R1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB radius&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
        <span class="s1">&#39;U1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="s1">&#39;U2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">37</span><span class="p">),</span>
        <span class="s1">&#39;R2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB radius&#39;</span><span class="p">,</span> <span class="mi">38</span><span class="p">),</span>
        <span class="s1">&#39;LAM_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Lateral fringe field extent (normally ≃ gap size)&#39;</span><span class="p">,</span> <span class="mi">39</span><span class="p">),</span>
        <span class="s1">&#39;XI_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Flag to activate/deactivate the lateral EFB (0 to deactivate)&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
        <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span>
        <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span>
        <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">43</span><span class="p">),</span>
        <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">44</span><span class="p">),</span>
        <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span>
        <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">46</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">47</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span>
        <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Lateral field boundary wedge angle&#39;</span><span class="p">,</span> <span class="mi">49</span><span class="p">),</span>
        <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Lateral EFB radius&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Lateral EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
        <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Lateral EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">52</span><span class="p">),</span>
        <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Lateral EFB radius&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="p">),</span>
        <span class="s1">&#39;RM3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Reference radius of the lateral EFB&#39;</span><span class="p">,</span> <span class="mi">54</span><span class="p">),</span>
        <span class="s1">&#39;IORDRE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span>
        <span class="s1">&#39;RESOL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">millimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">57</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span>
        <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
        <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">65</span><span class="p">),</span>
        <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">66</span><span class="p">),</span>
        <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">67</span><span class="p">),</span>
        <span class="s1">&#39;DP&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">63</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="s1">&#39;#4169E1&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Dipole.post_init"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Dipole.html#zgoubidoo.commands.magnetique.Dipole.post_init">[docs]</a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_E</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_S</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ACENT</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ACENT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RE</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RS</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">AT</span><span class="p">)</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">RM</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ACENT</span><span class="p">)</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">B0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">G</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> -1.0</span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U1_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U2_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> -1.0</span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U1_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U2_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_L</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XI_L</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_L</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_L</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_L</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1_L</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U1_L</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U2_L</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2_L</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">RM3</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IORDRE</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RESOL</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">RE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">TE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">RS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">TS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">DP</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> 0.0 0.0 0.0</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span>

<div class="viewcode-block" id="Dipole.fit"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Dipole.html#zgoubidoo.commands.magnetique.Dipole.fit">[docs]</a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">kinematics</span><span class="p">:</span> <span class="n">_Kinematics</span><span class="p">,</span>
            <span class="n">particle</span><span class="p">:</span> <span class="n">_ParticuleType</span> <span class="o">=</span> <span class="n">_Proton</span><span class="p">,</span>
            <span class="n">entry_coordinates</span><span class="p">:</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">exit_coordinate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="n">method</span><span class="p">:</span> <span class="n">_FitType</span> <span class="o">=</span> <span class="n">_Fit2</span><span class="p">,</span>
            <span class="n">zgoubi</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_Zgoubi</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            kinematics: the reference energy of the magnet</span>
<span class="sd">            particle: the particule type</span>
<span class="sd">            entry_coordinates: references 6D coordinates at the magnet entry</span>
<span class="sd">            exit_coordinate: the coordinate at the magnet exit</span>
<span class="sd">            method: the Zgoubi fitting command</span>
<span class="sd">            zgoubi: the `Zgoubi` instance used to launch the runs</span>
<span class="sd">            debug: verbose parent</span>

<span class="sd">        Returns:</span>
<span class="sd">            the `Dipole` itself (allows method chaining).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">entry_coordinates</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">entry_coordinates</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>

        <span class="n">z</span> <span class="o">=</span> <span class="n">zgoubi</span> <span class="ow">or</span> <span class="n">_Zgoubi</span><span class="p">()</span>
        <span class="n">zi</span> <span class="o">=</span> <span class="n">zgoubidoo</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FIT_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="si">}</span><span class="s2">_MAGNET&quot;</span><span class="p">)</span>
        <span class="n">zi</span> <span class="o">+=</span> <span class="n">_Objet2</span><span class="p">(</span><span class="s1">&#39;BUNCH&#39;</span><span class="p">,</span> <span class="n">BORO</span><span class="o">=</span><span class="n">kinematics</span><span class="o">.</span><span class="n">brho</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">entry_coordinates</span><span class="p">)</span>
        <span class="n">zi</span> <span class="o">+=</span> <span class="n">particle</span><span class="p">()</span>
        <span class="n">zi</span> <span class="o">+=</span> <span class="n">_Marker</span><span class="p">(</span><span class="s1">&#39;START&#39;</span><span class="p">)</span>
        <span class="n">zi</span> <span class="o">+=</span> <span class="bp">self</span>
        <span class="n">zi</span> <span class="o">+=</span> <span class="n">_Marker</span><span class="p">(</span><span class="s1">&#39;END&#39;</span><span class="p">)</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">PENALTY</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span>
                     <span class="n">PARAMS</span><span class="o">=</span><span class="p">[</span>
                         <span class="n">_Fit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">zi</span><span class="p">,</span> <span class="n">place</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="n">Dipole</span><span class="o">.</span><span class="n">B0_</span><span class="p">),</span>
                     <span class="p">],</span>
                     <span class="n">CONSTRAINTS</span><span class="o">=</span><span class="p">[</span>
                         <span class="n">_Fit</span><span class="o">.</span><span class="n">EqualityConstraint</span><span class="p">(</span>
                             <span class="n">line</span><span class="o">=</span><span class="n">zi</span><span class="p">,</span>
                             <span class="n">place</span><span class="o">=</span><span class="s1">&#39;END&#39;</span><span class="p">,</span>
                             <span class="n">variable</span><span class="o">=</span><span class="n">_Fit</span><span class="o">.</span><span class="n">FitCoordinates</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span>
                             <span class="n">value</span><span class="o">=</span><span class="n">exit_coordinate</span>
                         <span class="p">),</span>
                     <span class="p">]</span>
                     <span class="p">)</span><span class="o">.</span><span class="n">generate_label</span><span class="p">(</span><span class="s1">&#39;FIT_&#39;</span><span class="p">)</span>
        <span class="n">zi</span> <span class="o">+=</span> <span class="n">fit</span>

        <span class="k">def</span> <span class="nf">cb</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Post execution callback.&quot;&quot;&quot;</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">fit</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unable to fit </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B0</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;final&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fit</span> <span class="o">=</span> <span class="n">fit</span>

        <span class="n">z</span><span class="p">(</span><span class="n">zi</span><span class="p">,</span> <span class="n">identifier</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FITTING&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">},</span> <span class="n">cb</span><span class="o">=</span><span class="n">cb</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>


<div class="viewcode-block" id="DipoleM"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.DipoleM.html#zgoubidoo.commands.magnetique.DipoleM">[docs]</a><span class="k">class</span> <span class="nc">DipoleM</span><span class="p">(</span><span class="n">PolarMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;TODO.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DIPOLE-M&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;NFACE&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;IC&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># 1, 2: print field map</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># 1, 2: print field and coordinates on trajectores</span>
        <span class="s1">&#39;IAMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;IRMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;ACENT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RMIN&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_E&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_S&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;LAM_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;RM3&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NBS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DELTAB&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;IORDRE&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DP&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIM_R1&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_R2&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_THETA1&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_THETA2&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_LAMBDA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_GAMMA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_ALPHA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_BETA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_MU&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NFACE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error : Zgoubido does not support NFACE = </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NFACE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NFACE</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IC</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IAMAX</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IRMAX</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B0</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">G</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">AT</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">ACENT</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RM</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RMIN</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RMAX</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XI_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCE</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XI_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NFACE</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XI_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCL</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R1_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U1_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">U2_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R2_L</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RM3</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NBS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NBS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">DELTAB</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NBS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">DELTAB</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NBS</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

            <span class="n">shim_r1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R1</span><span class="p">)</span>
            <span class="n">shim_r2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R2</span><span class="p">)</span>
            <span class="n">shim_theta1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA1</span><span class="p">)</span>
            <span class="n">shim_theta2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA2</span><span class="p">)</span>
            <span class="n">shim_lambda</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_LAMBDA</span><span class="p">)</span>
            <span class="n">shim_gamma</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_GAMMA</span><span class="p">)</span>
            <span class="n">shim_alpha</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_ALPHA</span><span class="p">)</span>
            <span class="n">shim_beta</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_BETA</span><span class="p">)</span>
            <span class="n">shim_mu</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_MU</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">shim_r1</span>\
                    <span class="o">==</span> <span class="n">shim_r2</span> \
                    <span class="o">==</span> <span class="n">shim_theta1</span> \
                    <span class="o">==</span> <span class="n">shim_theta2</span> \
                    <span class="o">==</span> <span class="n">shim_lambda</span> \
                    <span class="o">==</span> <span class="n">shim_gamma</span> \
                    <span class="o">==</span> <span class="n">shim_alpha</span> \
                    <span class="o">==</span> <span class="n">shim_beta</span> \
                    <span class="o">==</span> <span class="n">shim_mu</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R1</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_R2</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA1</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_LAMBDA</span><span class="p">):</span>
                    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">l</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">GAMMA</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">MU</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">BETA</span><span class="p">):</span>
                    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                                   </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">l</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                                   &quot;&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s1">&#39;Error : The shim parameters lists must have the same lenghts&#39;</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IORDRE</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">TE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RS</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">TS</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">DP</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Dipoles"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Dipoles.html#zgoubidoo.commands.magnetique.Dipoles">[docs]</a><span class="k">class</span> <span class="nc">Dipoles</span><span class="p">(</span><span class="n">PolarMultiMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dipole magnet N-tuple, polar frame.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DIPOLES&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Number of magnets (maximum 5).&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Total angular extent of the N dipoles.&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Reference radius: mean radius used for the positioning of field boundaries&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
        <span class="s1">&#39;ACN&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Azimuth for dipole positioning&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="s1">&#39;DRM&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
                <span class="s1">&#39;Offset for the reference radius of each magnet : RM_i  = RM +DELTA_RM&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Dipole fields of each magnets.&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
        <span class="s1">&#39;BI&#39;</span><span class="p">:</span> <span class="p">([[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]],</span> <span class="s1">&#39;Lists of field coefficients for each magnets.&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="c1"># à partir d&#39;ici, on doit faire +ind pour tous les numéros de fit</span>
        <span class="s1">&#39;G0_E&#39;</span><span class="p">:</span> <span class="p">(</span>
        <span class="p">[</span><span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Reference gaps for the entrance fringe fields of each magnets.&#39;</span><span class="p">,</span>
        <span class="mi">9</span><span class="p">),</span>
        <span class="s1">&#39;K_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field parameter kappa&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>  <span class="c1"># 11 c&#39;est pour le NC</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span>
        <span class="s1">&#39;THETA_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Entrance face wedge angle&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;R1_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB radius&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;U1_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span>  <span class="c1">####-1e9 ?</span>
        <span class="s1">&#39;U2_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span>
        <span class="s1">&#39;R2_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB radius&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span>
        <span class="s1">&#39;G0_S&#39;</span><span class="p">:</span> <span class="p">(</span>
        <span class="p">[</span><span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Reference gaps for the exit fringe fields of each magnet.&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
        <span class="s1">&#39;K_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field parameter kappa&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>  <span class="c1"># 27 pour le NC</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
        <span class="s1">&#39;THETA_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Entrance face wedge angle&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="s1">&#39;R1_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB radius&#39;</span><span class="p">,</span> <span class="mi">37</span><span class="p">),</span>
        <span class="s1">&#39;U1_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">38</span><span class="p">),</span>  <span class="c1">####-1e9 ?</span>
        <span class="s1">&#39;U2_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">39</span><span class="p">),</span>
        <span class="s1">&#39;R2_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB radius&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
        <span class="s1">&#39;G0_L&#39;</span><span class="p">:</span> <span class="p">(</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;UNUSED Reference gaps for the lateral fringe fields of each dipole.&#39;</span><span class="p">,</span>
        <span class="mi">41</span><span class="p">),</span>
        <span class="s1">&#39;K_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field parameter kappa&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span>  <span class="c1">####POUR FIT : ne pas oublier NC unused</span>
        <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">44</span><span class="p">),</span>
        <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span>
        <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">46</span><span class="p">),</span>
        <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">47</span><span class="p">),</span>
        <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span>
        <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">49</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED  Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;UNUSED &#39;</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
        <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;UNUSED Entrance face wedge angle&#39;</span><span class="p">,</span> <span class="mi">52</span><span class="p">),</span>
        <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB radius&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="p">),</span>
        <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">54</span><span class="p">),</span>
        <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span>
        <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB radius&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">),</span>
        <span class="s1">&#39;RM3&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Unused.&#39;</span><span class="p">,</span> <span class="mi">57</span><span class="p">),</span>
        <span class="s1">&#39;KIRD&#39;</span><span class="p">:</span> <span class="p">(</span>
        <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Analytical computation (KIRD = 0) or numerical interpolation (KIRD = 2,4, 25) of field derivatives&#39;</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span>
        <span class="c1"># 111 (pour chaque dipole supplémentaire, faire +53 pour le fit)</span>
        <span class="s1">&#39;RESOL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">millimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">61</span><span class="p">),</span>
        <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">62</span><span class="p">),</span>
        <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">63</span><span class="p">),</span>
        <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
        <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">65</span><span class="p">),</span>
        <span class="s1">&#39;DP&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">62</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="s1">&#39;#4169E1&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Dipoles.post_init"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Dipoles.html#zgoubidoo.commands.magnetique.Dipoles.post_init">[docs]</a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
            <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ACN</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ACN</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
            <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RE</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RS</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">AT</span><span class="p">)</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">RM</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ACN</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">DRM</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">B0</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">BI</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">BI</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">G0_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">K_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            4 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U1_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U2_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">G0_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">K_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            4 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U1_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U2_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">G0_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">K_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            4 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U1_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U2_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">RM3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KIRD</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RESOL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">RE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">TE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">RS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">TS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">DP</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Dodecapole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Dodecapole.html#zgoubidoo.commands.magnetique.Dodecapole">[docs]</a><span class="k">class</span> <span class="nc">Dodecapole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Dodecapole magnet.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    The meaning of parameters for ``DODECAPO`` is the same as for ``QUADRUPO``.</span>

<span class="sd">    In fringe field regions the magnetic field :math:`\vec{B}(X, Y, Z)` and its derivatives up to fourth order are derived</span>
<span class="sd">    from the scalar potential approximated to the 6th order in Y and Z</span>

<span class="sd">    .. math::</span>

<span class="sd">        V(X,Y,Z) = G(X)(Y^4 − \frac{10}{3} Y^2 Z^2 + Z^4) YZ</span>

<span class="sd">    with :math:`G_0 = \frac{B_0}{R_0^5}`</span>

<span class="sd">    The modelling of the fringe field form factor G(X) is described under ``QUADRUPO``, p. 152.</span>
<span class="sd">    Outside fringe field regions, or everywhere in sharp edge dodecapole (:math:`λ_E = λ_S = 0`),</span>
<span class="sd">    :math:`\vec{B}(X, Y, Z)` in the magnet is given by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \begin{align}</span>
<span class="sd">            B_X &amp;= 0 \\</span>
<span class="sd">            B_Y &amp;= G_0 (5 Y^4 − 10 Y^2 Z^2 + Z^4) Z \\</span>
<span class="sd">            B_Z &amp;= G_0 (Y^4 − 10 Y^2 Z^2 + 5 Z^4) Y</span>
<span class="sd">        \end{align}</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DODECAPO&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Magnet length&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Radius of the pole tips&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tip&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;XE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face integration zone extent for the fringe field&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face fringe field extent (λ_E = 0 for sharp edge)&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="c1"># NCE: (0, &#39;UNUSED&#39;, 7)</span>
        <span class="s1">&#39;C0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
        <span class="s1">&#39;C1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="s1">&#39;C2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span>
        <span class="s1">&#39;C3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
        <span class="s1">&#39;C4&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
        <span class="s1">&#39;C5&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="s1">&#39;XS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face integration zone extent for the fringe field&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face fringe field extent&#39;</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Alignment parameter: 1 (element aligned) or 2 (misaligned)&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;X shift&#39;</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Y shift&#39;</span><span class="p">,</span> <span class="mi">72</span><span class="p">),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;Tilt&#39;</span><span class="p">,</span> <span class="mi">73</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;Magnet color for plotting.&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">         </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">         </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">         </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">B0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">         </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">         6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">         </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">         6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">         </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">         </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">         &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Drift"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Drift.html#zgoubidoo.commands.magnetique.Drift">[docs]</a><span class="k">class</span> <span class="nc">Drift</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Field free drift space.</span>

<span class="sd">    TODO</span>

<span class="sd">    &gt;&gt;&gt; Drift(XL=10 * _ureg.cm)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DRIFT&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Drift length&#39;</span><span class="p">),</span>
        <span class="s1">&#39;SPLIT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;Split the drift in multiple steps.&#39;</span><span class="p">),</span>
        <span class="s1">&#39;SPLITS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;If SPLITS &gt; 1, the drift will be split in multiple steps.&#39;</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Color used when plotting the element.&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">SPLIT</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">XL</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> split </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">SPLITS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">XL</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entry_s</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_ureg</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_trajectory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_trajectory</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">r</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">m</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">m</span>

<div class="viewcode-block" id="Drift.parse"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Drift.html#zgoubidoo.commands.magnetique.Drift.parse">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">stream</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;TODO&quot;&quot;&quot;</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &#39;</span><span class="si">{}</span><span class="s2">&#39; {label1:w}</span>
<span class="s2">        </span><span class="si">{XL_:.12e}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_parse</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">split</span><span class="p">()),</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span></div>

<div class="viewcode-block" id="Drift.adjust_tracks_variables"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Drift.html#zgoubidoo.commands.magnetique.Drift.adjust_tracks_variables">[docs]</a>    <span class="k">def</span> <span class="nf">adjust_tracks_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tracks</span><span class="p">:</span> <span class="n">_pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;SREF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_s</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;YT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;YT0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Yo&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;ZT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;ZT0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Zo&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;BX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;BY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;BZ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;EX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;EY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;EZ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span></div></div>


<div class="viewcode-block" id="ESL"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.ESL.html#zgoubidoo.commands.magnetique.ESL">[docs]</a><span class="k">class</span> <span class="nc">ESL</span><span class="p">(</span><span class="n">Drift</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Field free drift space (&quot;espace libre&quot;).&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="Emma"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Emma.html#zgoubidoo.commands.magnetique.Emma">[docs]</a><span class="k">class</span> <span class="nc">Emma</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;2-D Cartesian or cylindrical mesh field map for EMMA FFAG.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;EMMA&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="FFAG"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.FFAG.html#zgoubidoo.commands.magnetique.FFAG">[docs]</a><span class="k">class</span> <span class="nc">FFAG</span><span class="p">(</span><span class="n">PolarMultiMagnet</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;FFAG magnet, N-tuple.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    ``FFAG`` works much like ``DIPOLES`` as to the field modelling, apart from the radial dependence of the field,</span>
<span class="sd">    :math:`B = B_0 (\frac{r}{r_0})^k`, so-called “scaling”. Note that ``DIPOLES`` does similar job by using a Taylor</span>
<span class="sd">    r-expansion of :math:`B_0(\frac{r}{r_0})^k`. The FFAG procedure allows overlapping of fringe fields of neighboring</span>
<span class="sd">    dipoles, thus simulating in some sort the field in a dipole N-tuple - as for instance in an FFAG doublet or triplet.</span>
<span class="sd">    A detailed application, with five dipoles, can be found in Ref. [44]. This is done in the way described below.</span>

<span class="sd">    The dimensioning of the magnet is defined by :</span>

<span class="sd">        - AT : total angular aperture</span>
<span class="sd">        - RM : mean radius used for the positioning of field boundaries</span>

<span class="sd">    For each one of the N = 1 to (maximum) 5 dipoles of the N-tuple, the two effective field boundaries</span>
<span class="sd">    (entrance and exit EFBs) from which the dipole field is drawn are defined from geometric boundaries,</span>
<span class="sd">    the shape and position of which are determined by the following parameters</span>
<span class="sd">    (in the same manner as in ``DIPOLE``, ``DIPOLE-M`` ) (see Fig. 11-A page 98, and Fig. 31):</span>

<span class="sd">        - :math:`ACN_i` : arbitrary inner angle, used for EFBs positioning</span>
<span class="sd">        - ω : azimuth of an EFB with respect to ACN</span>
<span class="sd">        - θ : angle of an EFB with respect to its azimuth (wedge angle)</span>
<span class="sd">        - R1, R2 : radius of curvature of an EFB</span>
<span class="sd">        - U1, U2 : extent of the linear part of an EFB</span>

<span class="sd">    *Calculation of the Field From a Single Dipole*</span>

<span class="sd">    The magnetic field is calculated in polar coordinates. At all (R, θ) in the median plane (z = 0),</span>
<span class="sd">    the magnetic field due a single one (index i) of the dipoles of a N-tuple FFAG magnet is written</span>
<span class="sd">    $$B_{Z_i}(R, θ) = B_{Z_{0,i}} F_i(R, θ) (R/RM)^{K_i}$$</span>
<span class="sd">    wherein :math:`B_{Z_{0,i}}` is a reference field, at reference radius :math:`RM_i`,</span>
<span class="sd">    whereas F(R,θ) is calculated as described below.</span>


<span class="sd">    *Calculation of* :math:`F_i(R, θ)`</span>

<span class="sd">    The fringe field coefficient :math:`F_i(R, θ)` associated with a dipole is computed as in the procedure ``DIPOLES``</span>
<span class="sd">    (eq. 6.4.16), including (rigorously if the interpolation method is used, see page 125, or to order zero</span>
<span class="sd">    if the analytic method is used, see page 125) radial dependence of the gap size</span>
<span class="sd">    $$g(R) = g_0 (RM/R)^κ (6.4.19) $$</span>
<span class="sd">    so to simulate the effect of gap shaping on :math:`B_{Z_i}(R,θ)|_R` field fall-off, over the all radial extent of a</span>
<span class="sd">    scaling FFAG dipole (with normally - but not necessarily in practice - κ ≈ Ki).</span>

<span class="sd">    *Calculation of the Field Resulting From All N Dipoles*</span>

<span class="sd">    For the rest, namely, calculation of the full field at particle position from the N dipoles, analytical calculation</span>
<span class="sd">    or numerical interpolation of the mid-plane field derivatives, extrapolation off median plane, etc.,</span>
<span class="sd">    things are performed exactly as in the case of the ``DIPOLES`` procedure (see page 125).</span>

<span class="sd">    *Sharp Edge*</span>

<span class="sd">    Sharp edge field fall-off at a field boundary can only be simulated if the following conditions are fulfilled :</span>

<span class="sd">        - Entrance (resp. exit) field boundary coincides with entrance (resp. exit) dipole limit (it means in particular</span>
<span class="sd">          see Fig. 11, :math:`ω^+ = ACENT` (resp. :math:`ω^- = −(AT − ACENT`)), together with θ = 0 at entrance</span>
<span class="sd">          (resp. exit) EFBs)</span>

<span class="sd">        - Analytical method for calculation of the mid-plane field derivatives is used.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;FFAG&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Number of dipoles in the FFAG N -tuple (maximum 5)&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Total angular extent of the N dipoles&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Reference radius: mean radius used for the positioning of field boundaries&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
        <span class="c1"># For each magnet in the N-tuple</span>
        <span class="s1">&#39;ACN&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Azimuth for dipole positioning&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="s1">&#39;DRM&#39;</span><span class="p">:</span> <span class="p">(</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
            <span class="s1">&#39;Offset for the reference radius of each dipole RM_i  = RM + DRM&#39;</span><span class="p">,</span> <span class="mi">6</span>
        <span class="p">),</span>
        <span class="s1">&#39;BZ0&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field of each dipole&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
        <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;Field index for each dipole&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="s1">&#39;G0_E&#39;</span><span class="p">:</span> <span class="p">(</span>
            <span class="p">[</span><span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span>
            <span class="s1">&#39;Reference gaps for the entrance fringe fields of each dipole.&#39;</span><span class="p">,</span> <span class="mi">9</span>
        <span class="p">),</span>
        <span class="s1">&#39;K_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field parameter kappa&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span>
        <span class="s1">&#39;THETA_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Entrance face wedge angle&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;R1_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB radius&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;U1_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span>
        <span class="s1">&#39;U2_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span>
        <span class="s1">&#39;R2_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB radius&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span>
        <span class="s1">&#39;G0_S&#39;</span><span class="p">:</span> <span class="p">(</span>
            <span class="p">[</span><span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span>
            <span class="s1">&#39;Reference gaps for the exit fringe fields of each dipole.&#39;</span><span class="p">,</span> <span class="mi">25</span>
        <span class="p">),</span>
        <span class="s1">&#39;K_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field parameter kappa&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
        <span class="s1">&#39;THETA_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Entrance face wedge angle&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="s1">&#39;R1_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB radius&#39;</span><span class="p">,</span> <span class="mi">37</span><span class="p">),</span>
        <span class="s1">&#39;U1_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">38</span><span class="p">),</span>
        <span class="s1">&#39;U2_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">39</span><span class="p">),</span>
        <span class="s1">&#39;R2_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB radius&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
        <span class="s1">&#39;G0_L&#39;</span><span class="p">:</span> <span class="p">(</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span>
            <span class="s1">&#39;UNUSED Reference gaps for the lateral fringe fields of each dipole.&#39;</span><span class="p">,</span> <span class="mi">41</span>
        <span class="p">),</span>
        <span class="s1">&#39;K_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field parameter kappa&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span>
        <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">44</span><span class="p">),</span>
        <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span>
        <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">46</span><span class="p">),</span>
        <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">47</span><span class="p">),</span>
        <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span>
        <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">49</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED  Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;UNUSED &#39;</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
        <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;UNUSED Entrance face wedge angle&#39;</span><span class="p">,</span> <span class="mi">52</span><span class="p">),</span>
        <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB radius&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="p">),</span>
        <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">54</span><span class="p">),</span>
        <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span>
        <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB radius&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">),</span>
        <span class="c1"># General parameters</span>
        <span class="c1"># The fit index depends on the number of magnets in the FFAG N -tuple (+52 for each new magnet)</span>
        <span class="s1">&#39;KIRD&#39;</span><span class="p">:</span> <span class="p">(</span>
            <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Analytical computation (KIRD = 0) or numerical interpolation (KIRD = 2,4, 25) of field derivatives&#39;</span><span class="p">,</span> <span class="mi">57</span>
        <span class="p">),</span>
        <span class="s1">&#39;RESOL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">millimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">61</span><span class="p">),</span>
        <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">62</span><span class="p">),</span>
        <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">63</span><span class="p">),</span>
        <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
        <span class="s1">&#39;DP&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">61</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="s1">&#39;#4169E1&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

<div class="viewcode-block" id="FFAG.post_init"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.FFAG.html#zgoubidoo.commands.magnetique.FFAG.post_init">[docs]</a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
            <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ACN</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ACN</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
            <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RE</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RS</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;       </span>
<span class="s2">            </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">AT</span><span class="p">)</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">RM</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ACN</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">DRM</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">BZ0</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">G0_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">K_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U1_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U2_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2_E</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">G0_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">K_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U1_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U2_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">G0_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">K_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U1_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U2_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KIRD</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RESOL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">RE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">TE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">RS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">TS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">DP</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="FFAGSpirale"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.FFAGSpirale.html#zgoubidoo.commands.magnetique.FFAGSpirale">[docs]</a><span class="k">class</span> <span class="nc">FFAGSpirale</span><span class="p">(</span><span class="n">PolarMultiMagnet</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Spiral FFAG magnet, N-tuple.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    ``FFAG-SPI`` works much like ``FFAG`` as to the field modelling, with essentially a different axial dependence.</span>
<span class="sd">    The ``FFAG-SPI`` procedure allows overlapping of fringe fields of neighboring dipoles, thus simulating in some sort</span>
<span class="sd">    the field in a dipole N-tuple (similar to Fig. 31, page 137).</span>
<span class="sd">    This allows for instance accounting for fringe field effects, or clamps, as schemed in Fig. 32.</span>

<span class="sd">    The dimensioning of the magnet is defined by :</span>

<span class="sd">        - AT : total angular aperture</span>
<span class="sd">        - RM : mean radius used for the positioning of field boundaries</span>

<span class="sd">    For each one of the N = 1 to (maximum) 5 dipoles of the N-tuple, the two effective field boundaries</span>
<span class="sd">    (entrance and exit EFBs) from which the dipole field is drawn are defined from geometric boundaries,</span>
<span class="sd">    the shape and position of which are determined by the following parameters:</span>

<span class="sd">        - :math:`ACN_i` : arbitrary inner angle, used for EFBs positioning</span>
<span class="sd">        - ω : azimuth of an EFB with respect to ACN</span>
<span class="sd">        - ξ : spiral angle</span>

<span class="sd">    with :math:`ACN_i` and ω as defined in Fig. 32 (similar to what can be found in Figs. 31 and 11-A).</span>

<span class="sd">    *Calculation of the Field From a Single Dipole*</span>

<span class="sd">    The magnetic field is calculated in polar coordinates. At all (R, θ) in the median plane (Z = 0),</span>
<span class="sd">    the magnetic field due a single one (index i) of the dipoles of a N-tuple spiral FFAG magnet is written</span>
<span class="sd">    $$B_{Z_i}(R, θ) = B_{Z_{0,i}} F_i(R, θ) (R/RM )^{K_i}$$</span>
<span class="sd">    wherein :math:`B_{Z_{0,i}}` is a reference field, at reference radius :math:`RM_i`, whereas :math:`F(R,θ)` is</span>
<span class="sd">    calculated as described below.</span>

<span class="sd">    *Calculation of* :math:`F_i(R, θ)`</span>

<span class="sd">    The fringe field coefficient :math:`F_i(R, θ)` associated with a dipole is computed as in the procedure ``DIPOLES``</span>
<span class="sd">    (eq. 6.4.16), including radial dependence of the gap size :</span>
<span class="sd">    $$g(R) = g_0 (RM/R)^κ$$</span>
<span class="sd">    so to simulate the effect of gap shaping on :math:`B_{Z_i}(R,θ)|_R` field fall-off, over the all radial extent of</span>
<span class="sd">    the dipole (with normally - yet not necessarily in practice - κ ≈ Ki).</span>


<span class="sd">    *Calculation of the Full Field From All N Dipoles*</span>

<span class="sd">    For the rest, namely calculation of the full field at particle position, as resulting from the N dipoles,</span>
<span class="sd">    calculation of the mid-plane field derivatives, extrapolation off median plane, etc.,</span>
<span class="sd">    things are performed in the same manner as for the ``DIPOLES`` procedure (see page 125).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;FFAG-SPI&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Number of dipoles in the FFAG n-tuple (maximum 5)&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Total angular extent of the N dipoles&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Reference radius: mean radius used for the positioning of field boundaries&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
        <span class="c1"># For each magnet in the n-tuple</span>
        <span class="s1">&#39;ACN&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Azimuth for dipole positioning&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="s1">&#39;DRM&#39;</span><span class="p">:</span> <span class="p">(</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
            <span class="s1">&#39;Reference radius offset of each dipole : RM_i  = RM + DRM&#39;</span><span class="p">,</span> <span class="mi">6</span>
        <span class="p">),</span>
        <span class="s1">&#39;BZ0&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at the reference radius of each dipole&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
        <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;Field index for each dipole&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="s1">&#39;G0_E&#39;</span><span class="p">:</span> <span class="p">(</span>
            <span class="p">[</span><span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span>
            <span class="s1">&#39;Reference gaps for the entrance fringe fields of each dipole.&#39;</span><span class="p">,</span> <span class="mi">9</span>
        <span class="p">),</span>
        <span class="s1">&#39;K_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field parameter kappa&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Azimuth of an EFB with respect to ACN&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span>
        <span class="s1">&#39;XI_E&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Spiral angle&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;G0_S&#39;</span><span class="p">:</span> <span class="p">(</span>
            <span class="p">[</span><span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">,</span> <span class="mf">0.00000001</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span>
            <span class="s1">&#39;Reference gaps for the exit fringe fields of each dipole.&#39;</span><span class="p">,</span> <span class="mi">25</span>
        <span class="p">),</span>
        <span class="s1">&#39;K_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field parameter kappa&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span>
        <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Azimuth of an EFB with respect to ACN&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
        <span class="s1">&#39;XI_S&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Spiral angle&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="s1">&#39;G0_L&#39;</span><span class="p">:</span> <span class="p">(</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span>
            <span class="s1">&#39;UNUSED Reference gaps for the lateral fringe fields of each dipole.&#39;</span><span class="p">,</span><span class="mi">41</span>
        <span class="p">),</span>
        <span class="s1">&#39;K_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field parameter kappa&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span>
        <span class="s1">&#39;NCL&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED&#39;</span><span class="p">,</span> <span class="mi">43</span><span class="p">),</span>
        <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">44</span><span class="p">),</span>
        <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span>
        <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">46</span><span class="p">),</span>
        <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">47</span><span class="p">),</span>
        <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span>
        <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNUSED Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">49</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED  Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;UNUSED &#39;</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
        <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;UNUSED Entrance face wedge angle&#39;</span><span class="p">,</span> <span class="mi">52</span><span class="p">),</span>
        <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB radius&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="p">),</span>
        <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">54</span><span class="p">),</span>
        <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span>
        <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">]</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;UNUSED Lateral EFB radius&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">),</span>
        <span class="c1"># General parameters</span>
        <span class="c1"># The fit index depends on the number of magnets in the FFAG_SPI N-tuple (+52 for each new magnet)</span>
        <span class="s1">&#39;KIRD&#39;</span><span class="p">:</span> <span class="p">(</span>
            <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Analytical computation (KIRD = 0) or numerical interpolation (KIRD = 2,4, 25) of field derivatives&#39;</span><span class="p">,</span> <span class="mi">57</span>
        <span class="p">),</span>
        <span class="s1">&#39;RESOL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">millimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
        <span class="c1"># &#39;KPOS&#39;: (2, &#39;&#39;, 60), # KPOS = 2 for FFA-SPI</span>
        <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">61</span><span class="p">),</span>
        <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">62</span><span class="p">),</span>
        <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">63</span><span class="p">),</span>
        <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

<div class="viewcode-block" id="FFAGSpirale.adjust_tracks_variables"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.FFAGSpirale.html#zgoubidoo.commands.magnetique.FFAGSpirale.adjust_tracks_variables">[docs]</a>    <span class="k">def</span> <span class="nf">adjust_tracks_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tracks</span><span class="p">:</span> <span class="n">_pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">]</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;radians&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;ANGLE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">angles</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;R0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Yo&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;SREF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">angles</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_s</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;YT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">radius</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;YT0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Yo&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">radius</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;ZT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;ZT0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Zo&#39;</span><span class="p">]</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;X0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Yo&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">-</span> <span class="n">radius</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tracks</span><span class="o">.</span><span class="n">LABEL1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL1</span><span class="p">,</span> <span class="s1">&#39;Y0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Yo&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">-</span> <span class="n">radius</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">reference_angles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">_Q</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">acn</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">acn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ACN</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entry_wedge_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">_Q</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">XI_E</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit_wedge_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">_Q</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">XI_S</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">AT</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RM</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">ACN</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">DRM</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">BZ0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">G0_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">K_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XI_E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> 0.0 0.0 0.0 0.0</span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">G0_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">K_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XI_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> 0.0 0.0 0.0 0.0</span>
<span class="s2">            </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">G0_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">K_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">NCL</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIFT_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">OMEGA_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.20e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_degree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">THETA_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U1_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">U2_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2_L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KIRD</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RESOL</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            2</span>
<span class="s2">            </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RE</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">TE</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;radian&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">RS</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">TS</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;radian&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Multipole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Multipole.html#zgoubidoo.commands.magnetique.Multipole">[docs]</a><span class="k">class</span> <span class="nc">Multipole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Magnetic multipole.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    The simulation of multipolar magnetic field M⃗ by MULTIPOL proceeds by addition of the dipolar (B1),</span>
<span class="sd">    quadrupolar (B2), sextupolar (B3), etc., up to 20-polar (B10) components, and of their derivatives up to fourth</span>
<span class="sd">    order.</span>

<span class="sd">    The independent components B1, B2, B3, ..., B10 and their derivatives up to the fourth order are calculated as</span>
<span class="sd">    described in section 1.3.7.</span>

<span class="sd">    The entrance and exit fringe fields are treated separately. They are characterized by the integration zone XE at</span>
<span class="sd">    entrance and XS at exit, as for QUADRUPO, and by the extent λE at entrance, λS at exit. The fringe field extents</span>
<span class="sd">    for the dipole component are λE and λS. The fringe field for the quadrupolar (sextupolar, ..., 20-polar) component</span>
<span class="sd">    is given by a coefficient E2 (E3, ..., E10) at entrance, and S2 (S3, ..., S10) at exit, such that the extent is</span>
<span class="sd">    λE * E2 (λE * E3, ..., λE * E10) at entrance and λS * S2 (λS * S3, ..., λS * S10) at exit.</span>

<span class="sd">    If λE = 0 (λS = 0) the multipole lens is considered to have a sharp edge field at entrance (exit), and then,</span>
<span class="sd">    XE (XS) is forced to zero (for the mere purpose of saving computing time). If Ei = 0 (Si = 0) (i = 2, 10), the</span>
<span class="sd">    entrance (exit) fringe field for the multipole component i is considered as a sharp edge field. In sharp edge field</span>
<span class="sd">    model, the wedge angle vertical first order focusing effect (if B1 is non zero) is simulated at magnet entrance and</span>
<span class="sd">    exit by a kick P2 = P1 − Z1 tan(ε/ρ) applied to each particle (P1, P2 are the vertical angles upstream and</span>
<span class="sd">    downstream of the EFB, Z1 is the vertical particle position at the EFB, ρ the local horizontal bending radius and</span>
<span class="sd">    ε the wedge angle experienced by the particle ; ε depends on the horizontal angle T).</span>

<span class="sd">    Any multipole component Bi can be rotated independently by an angle RXi around the longitudinal X- axis, for the</span>
<span class="sd">    simulation of positioning defects, as well as skew lenses.</span>

<span class="sd">    Magnet (mis-)alignment is assured by KPOS. KPOS also allows some degrees of automatic alignment useful for periodic</span>
<span class="sd">    structures (section 4.6.7).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;MULTIPOL&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Magnet length&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Radius of the pole tips&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="s1">&#39;B1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tip for dipolar component.&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="s1">&#39;B2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tip for quadrupolar component.&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
            <span class="s1">&#39;B3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tip for sextupolar component.&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
            <span class="s1">&#39;B4&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tip for octupolar component.&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
            <span class="s1">&#39;B5&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tip for decapolar component.&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
            <span class="s1">&#39;B6&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tip for dodecapolar component.&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="s1">&#39;B7&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tip for 14-polar component.&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
            <span class="s1">&#39;B8&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tip for 16-polar component.&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
            <span class="s1">&#39;B9&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tip for 18-polar component.&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
            <span class="s1">&#39;B10&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tip for 20-polar component.&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
            <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Entrance face integration zone for the fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Entrance face fringe field extent&#39;</span><span class="p">),</span>
            <span class="s1">&#39;E2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Quadrupole entrance fringe field extent (E_2 * LAM_E).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;E3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Sextupolar entrance fringe field extent (E_3 * LAM_E).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;E4&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Octupolar entrance fringe field extent (E_4 * LAM_E).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;E5&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Decapolar entrance fringe field extent (E_5 * LAM_E).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;E6&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Dodecapolar entrance fringe field extent (E_6 * LAM_E).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;E7&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;14-polar entrance fringe field extent (E_7 * LAM_E).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;E8&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;16-polar entrance fringe field extent (E_8 * LAM_E).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;E9&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;18-polar entrance fringe field extent (E_9 * LAM_E).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;E10&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;20-polar entrance fringe field extent (E_10 * LAM_E).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Zeroth-order Enge coefficient for entrance fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;First-order Enge coefficient for entrance fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Second-order Enge coefficient for entrance fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Third-order Enge coefficient for entrance fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fourth-order Enge coefficient for entrance fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fifth-order Enge coefficient for entrance fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Exit face integration zone for the fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Exit face fringe field extent&#39;</span><span class="p">),</span>
            <span class="s1">&#39;S2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Quadrupole exit fringe field extent (E_2 * LAM_S).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;S3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Sextupolar exit fringe field extent (E_3 * LAM_S).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;S4&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Octupolar exit fringe field extent (E_4 * LAM_S).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;S5&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Decapolar exit fringe field extent (E_5 * LAM_S).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;S6&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Dodecapolar exit fringe field extent (E_6 * LAM_S).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;S7&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;14-polar exit fringe field extent (E_7 * LAM_S).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;S8&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;16-polar exit fringe field extent (E_8 * LAM_S).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;S9&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;18-polar exit fringe field extent (E_9 * LAM_S).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;S10&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;20-polar exit fringe field extent (E_10 * LAM_S).&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Zeroth-order Enge coefficient for entrance fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;First-order Enge coefficient for exit fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Second-order Enge coefficient for exit fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Third-order Enge coefficient for exit fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fourth-order Enge coefficient for exit fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fifth-order Enge coefficient for exit fringe field.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;R1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Skew angle of the dipolar component&#39;</span><span class="p">),</span>
            <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Skew angle of the quadrupolar component&#39;</span><span class="p">),</span>
            <span class="s1">&#39;R3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Skew angle of the sextupolar component&#39;</span><span class="p">),</span>
            <span class="s1">&#39;R4&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Skew angle of the octupolar component&#39;</span><span class="p">),</span>
            <span class="s1">&#39;R5&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Skew angle of the decapolar component&#39;</span><span class="p">),</span>
            <span class="s1">&#39;R6&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Skew angle of the dodecapolar component&#39;</span><span class="p">),</span>
            <span class="s1">&#39;R7&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Skew angle of the 14-polar component&#39;</span><span class="p">),</span>
            <span class="s1">&#39;R8&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Skew angle of the 16-polar component&#39;</span><span class="p">),</span>
            <span class="s1">&#39;R9&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Skew angle of the 18-polar component&#39;</span><span class="p">),</span>
            <span class="s1">&#39;R10&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Skew angle of the 20-polar component&#39;</span><span class="p">),</span>
            <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;Integration step.&#39;</span><span class="p">),</span>
            <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
            <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
            <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
            <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
            <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;Magnet color for plotting.&#39;</span><span class="p">),</span>

    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B1</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B2</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B3</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B4</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B5</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B6</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B7</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B8</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B9</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B10</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;kilogauss&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">X_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">E2</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">E3</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">E4</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">E5</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">E6</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">E7</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">E8</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">E9</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">E10</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">X_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">S2</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">S3</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">S4</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">S5</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">S6</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">S7</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">S8</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">S9</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">S10</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R1</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R2</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R3</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R4</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R5</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R6</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R7</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R8</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R9</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R10</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span></div>


<span class="n">Multipol</span> <span class="o">=</span> <span class="n">Multipole</span>


<div class="viewcode-block" id="Octupole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Octupole.html#zgoubidoo.commands.magnetique.Octupole">[docs]</a><span class="k">class</span> <span class="nc">Octupole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Octupole magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;OCTUPOLE&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Magnet length&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Radius of the pole tips&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tips&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face integration zone for the fringe field&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face fringe field extent&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face integration zone for the fringe field&#39;</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face fringe field extent&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Misalignment type&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;x offset&#39;</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;y offset&#39;</span><span class="p">,</span> <span class="mi">72</span><span class="p">),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;misalignment rotation&#39;</span><span class="p">,</span> <span class="mi">73</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;#FF33E9&#39;</span><span class="p">,</span> <span class="s1">&#39;Magnet color for plotting.&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Octupole.post_init"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Octupole.html#zgoubidoo.commands.magnetique.Octupole.post_init">[docs]</a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_E</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LAM_E</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_E</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_S</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LAM_S</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_S</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">B0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">X_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">X_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Octopolar gradient (field at pole tip divided by the bore radius.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">B0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>

    <span class="nd">@gradient</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B0</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span></div>


<div class="viewcode-block" id="PS170"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PS170.html#zgoubidoo.commands.magnetique.PS170">[docs]</a><span class="k">class</span> <span class="nc">PS170</span><span class="p">(</span><span class="n">Magnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simulation of a round shape dipole magnet.</span>

<span class="sd">    TODO</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; PS170(&#39;PS170&#39;, IL=2, XL=2 * _ureg.m, R0 = 1.5 * _ureg.m, B0 = 1 * _ureg.tesla)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;PS170&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;print field and coordinates along trajectories&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;Length of the element&#39;</span><span class="p">),</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;, radius of the circular dipole&#39;</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">tesla</span><span class="p">,</span> <span class="s1">&#39;field&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">mm</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be in (0, 1, 2)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IL</span><span class="p">)</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">B0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2">  </span>
<span class="s2">        </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span><span class="p">)</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Quadisex"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Quadisex.html#zgoubidoo.commands.magnetique.Quadisex">[docs]</a><span class="k">class</span> <span class="nc">Quadisex</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sharp edge magnetic multipoles.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;QUADISEX&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EB1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EB2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EG1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EG2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XL</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">EB1</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">EB2</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">EG1</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">EG2</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2">  </span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Quadrupole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Quadrupole.html#zgoubidoo.commands.magnetique.Quadrupole">[docs]</a><span class="k">class</span> <span class="nc">Quadrupole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Quadrupole magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;QUADRUPO&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Magnet length&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Radius of the pole tips&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tips&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face integration zone for the fringe field&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face fringe field extent&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face integration zone for the fringe field&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face fringe field extent&#39;</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">52</span><span class="p">),</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="p">),</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">54</span><span class="p">),</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Misalignment type&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;x offset&#39;</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;y offset&#39;</span><span class="p">,</span> <span class="mi">72</span><span class="p">),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;misalignment rotation&#39;</span><span class="p">,</span> <span class="mi">73</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;#FF0000&#39;</span><span class="p">,</span> <span class="s1">&#39;Magnet color for plotting.&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Quadrupole.post_init"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Quadrupole.html#zgoubidoo.commands.magnetique.Quadrupole.post_init">[docs]</a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_E</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LAM_E</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_E</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_S</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LAM_S</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_S</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">B0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">X_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">X_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Quadrupolar gradient (field at pole tip divided by the bore radius.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">B0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>

    <span class="nd">@gradient</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B0</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span></div>


<div class="viewcode-block" id="SexQuad"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.SexQuad.html#zgoubidoo.commands.magnetique.SexQuad">[docs]</a><span class="k">class</span> <span class="nc">SexQuad</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sharp edge magnetic multipole.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;SEXQUAD&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EB1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EB2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EG1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EG2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XL</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">B0</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">EB1</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">EB2</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">EG1</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">EG2</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2">  </span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="c1"># Coefficients for the calculation of B.</span>
        <span class="c1"># if Y &gt; 0 : B = EB1 and G = EG1;</span>
        <span class="c1"># if Y &lt; 0: B = EB2 and G = EG2.</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># XCE, YCE and ALE set to 0 and unused</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Elements are misaligned</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Sextupole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Sextupole.html#zgoubidoo.commands.magnetique.Sextupole">[docs]</a><span class="k">class</span> <span class="nc">Sextupole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sextupole magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;SEXTUPOL&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Magnet length&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Radius of the pole tips&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tips&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;XE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face integration zone for the fringe field&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face fringe field extent&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face integration zone for the fringe field&#39;</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face fringe field extent&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Misalignment type&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;x offset&#39;</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;y offset&#39;</span><span class="p">,</span> <span class="mi">72</span><span class="p">),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;#00FF00&#39;</span><span class="p">,</span> <span class="s1">&#39;Magnet color for plotting.&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">B0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_E</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_E</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">LAM_S</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C0_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C1_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C2_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C3_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C4_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">C5_S</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Solenoid"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Solenoid.html#zgoubidoo.commands.magnetique.Solenoid">[docs]</a><span class="k">class</span> <span class="nc">Solenoid</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solenoid.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    The solenoidal m􏰛agnet has an effective length XL, a mean radius R0 and an asymptotic field B0 = μ0 NI/XL,</span>
<span class="sd">    wherein BX is the longitudinal field component, and NI the number of Ampere-Turns.</span>

<span class="sd">    The distance of ray-tracing beyond the effective length XL, is XE at the entrance, and XS at the exit.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;SOLENOID&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Magnet length&#39;</span><span class="p">),</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Radius&#39;</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Asymptotic field&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face integration zone for the fringe field&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face integration zone for the fringe field&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Misalignment type&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;x offset&#39;</span><span class="p">),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;y offset&#39;</span><span class="p">),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">IL</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">B0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Undulator"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Undulator.html#zgoubidoo.commands.magnetique.Undulator">[docs]</a><span class="k">class</span> <span class="nc">Undulator</span><span class="p">(</span><span class="n">Magnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Undulator magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;UNDULATOR&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Venus"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Venus.html#zgoubidoo.commands.magnetique.Venus">[docs]</a><span class="k">class</span> <span class="nc">Venus</span><span class="p">(</span><span class="n">Magnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simulation of a rectangular shaped dipole magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;VENUS&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,),</span>
        <span class="s1">&#39;YL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be in (0, 1, 2)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IL</span><span class="p">)</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">YL</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_kilogauss</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">B0</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XPAS</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2">  </span>
<span class="s2">        </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span><span class="p">)</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">YCE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_radian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ALE</span><span class="p">)</span><span class="si">:</span><span class="s2">.12e</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018-2020, Cédric Hernalsteens (cedric.hernalsteens@ulb.be)

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>