

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>zgoubidoo.commands.magnetique &mdash; Zgoubidoo 2019.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Zgoubidoo
          

          
          </a>

          
            
            
              <div class="version">
                2019.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../news.html">News and announcements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zgoubi.html">Zgoubi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../commands.html">Zgoubi commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contrib.html">Zgoubidoo specialized and contributed commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../input.html">Working with Zgoubi Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../lowlevel.html">Using the Zgoubidoo low-level interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../beam.html">Working with Zgoubidoo beams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sequence.html">Working with Zgoubidoo sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../vis.html">Zgoubidoo’s visualization and plotting module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../utilities.html">Zgoubidoo’s utility modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Zgoubidoo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>zgoubidoo.commands.magnetique</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for zgoubidoo.commands.magnetique</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Zgoubidoo&#39;s interfaces to purefly magnetic Zgoubi commands.</span>

<span class="sd">More details here.</span>
<span class="sd">TODO</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">NoReturn</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">_np</span>
<span class="kn">import</span> <span class="nn">parse</span> <span class="k">as</span> <span class="nn">_parse</span>
<span class="kn">from</span> <span class="nn">.particules</span> <span class="k">import</span> <span class="n">ParticuleType</span> <span class="k">as</span> <span class="n">_ParticuleType</span>
<span class="kn">from</span> <span class="nn">.commands</span> <span class="k">import</span> <span class="n">CommandType</span> <span class="k">as</span> <span class="n">_CommandType</span>
<span class="kn">from</span> <span class="nn">.commands</span> <span class="k">import</span> <span class="n">FitType</span> <span class="k">as</span> <span class="n">_FitType</span>
<span class="kn">from</span> <span class="nn">.commands</span> <span class="k">import</span> <span class="n">Command</span> <span class="k">as</span> <span class="n">_Command</span>
<span class="kn">from</span> <span class="nn">.commands</span> <span class="k">import</span> <span class="n">Marker</span> <span class="k">as</span> <span class="n">_Marker</span>
<span class="kn">from</span> <span class="nn">.commands</span> <span class="k">import</span> <span class="n">Fit2</span> <span class="k">as</span> <span class="n">_Fit2</span>
<span class="kn">from</span> <span class="nn">.commands</span> <span class="k">import</span> <span class="n">ZgoubidooException</span> <span class="k">as</span> <span class="n">_ZgoubidooException</span>
<span class="kn">from</span> <span class="nn">.objet</span> <span class="k">import</span> <span class="n">Objet2</span> <span class="k">as</span> <span class="n">_Objet2</span>
<span class="kn">from</span> <span class="nn">.particules</span> <span class="k">import</span> <span class="n">Proton</span> <span class="k">as</span> <span class="n">_Proton</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">ureg</span> <span class="k">as</span> <span class="n">_ureg</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">_Q</span>
<span class="kn">from</span> <span class="nn">..frame</span> <span class="k">import</span> <span class="n">Frame</span> <span class="k">as</span> <span class="n">_Frame</span>
<span class="kn">from</span> <span class="nn">..vis</span> <span class="k">import</span> <span class="n">ZgoubiPlot</span> <span class="k">as</span> <span class="n">_ZgoubiPlot</span>
<span class="kn">from</span> <span class="nn">.patchable</span> <span class="k">import</span> <span class="n">Patchable</span> <span class="k">as</span> <span class="n">_Patchable</span>
<span class="kn">from</span> <span class="nn">.plotable</span> <span class="k">import</span> <span class="n">Plotable</span> <span class="k">as</span> <span class="n">_Plotable</span>
<span class="kn">from</span> <span class="nn">..units</span> <span class="k">import</span> <span class="n">_cm</span><span class="p">,</span> <span class="n">_radian</span><span class="p">,</span> <span class="n">_kilogauss</span><span class="p">,</span> <span class="n">_degree</span>
<span class="kn">import</span> <span class="nn">zgoubidoo</span>


<div class="viewcode-block" id="MagnetType"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.MagnetType.html#zgoubidoo.commands.magnetique.MagnetType">[docs]</a><span class="k">class</span> <span class="nc">MagnetType</span><span class="p">(</span><span class="n">_CommandType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Type for magnetic element commands.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="Magnet"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Magnet.html#zgoubidoo.commands.magnetique.Magnet">[docs]</a><span class="k">class</span> <span class="nc">Magnet</span><span class="p">(</span><span class="n">_Command</span><span class="p">,</span> <span class="n">_Patchable</span><span class="p">,</span> <span class="n">_Plotable</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">MagnetType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for all magnetic elements.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;HEIGHT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="CartesianMagnetType"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.CartesianMagnetType.html#zgoubidoo.commands.magnetique.CartesianMagnetType">[docs]</a><span class="k">class</span> <span class="nc">CartesianMagnetType</span><span class="p">(</span><span class="n">MagnetType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Type for cartesian magnets.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="CartesianMagnet"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.CartesianMagnet.html#zgoubidoo.commands.magnetique.CartesianMagnet">[docs]</a><span class="k">class</span> <span class="nc">CartesianMagnet</span><span class="p">(</span><span class="n">Magnet</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">CartesianMagnetType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for magnetic elements in cartesian coordinates.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;WIDTH&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">50</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ALE</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">XL</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">x_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">XCE</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">y_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">YCE</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entry_patched</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Frame</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span> <span class="o">=</span> <span class="n">_Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_E</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_offset</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">translate_y</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_offset</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">rotate_z</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Frame</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span> <span class="o">=</span> <span class="n">_Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_patched</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_E</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_S</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit_patched</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Frame</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span> <span class="o">=</span> <span class="n">_Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_S</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span> <span class="o">=</span> <span class="n">_Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span><span class="o">.</span><span class="n">translate_x</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XL</span> <span class="ow">or</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span>

<div class="viewcode-block" id="CartesianMagnet.plot"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.CartesianMagnet.html#zgoubidoo.commands.magnetique.CartesianMagnet.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artist</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NoReturn</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">artist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">CartesianMagnet</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">())(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="CartesianMagnet.plot_tracks"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.CartesianMagnet.html#zgoubidoo.commands.magnetique.CartesianMagnet.plot_tracks">[docs]</a>    <span class="k">def</span> <span class="nf">plot_tracks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NoReturn</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">artist</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">tracks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">f</span><span class="s2">&quot;tracks_{CartesianMagnet.__name__.lower()}&quot;</span><span class="p">)(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tracks</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PolarMagnetType"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnetType.html#zgoubidoo.commands.magnetique.PolarMagnetType">[docs]</a><span class="k">class</span> <span class="nc">PolarMagnetType</span><span class="p">(</span><span class="n">MagnetType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Type for polar magnets.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="PolarMagnet"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnet.html#zgoubidoo.commands.magnetique.PolarMagnet">[docs]</a><span class="k">class</span> <span class="nc">PolarMagnet</span><span class="p">(</span><span class="n">Magnet</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">PolarMagnetType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for magnetic elements in polar coordinates.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;WIDTH&#39;</span><span class="p">:</span> <span class="mi">150</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">angular_opening</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">reference_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ACENT</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entrance_efb</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_E</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit_efb</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_S</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">angular_opening</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entry_patched</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span> <span class="o">=</span> <span class="n">_Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">translate_y</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RE</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span><span class="o">.</span><span class="n">rotate_z</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TE</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_patched</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_center</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_center</span> <span class="o">=</span> <span class="n">_Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_patched</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_center</span><span class="o">.</span><span class="n">translate_y</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_center</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Frame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span> <span class="o">=</span> <span class="n">_Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span><span class="o">.</span><span class="n">translate_y</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span><span class="o">.</span><span class="n">rotate_z</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">angular_opening</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exit_patched</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Frame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span> <span class="o">=</span> <span class="n">_Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span><span class="o">.</span><span class="n">translate_y</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">RS</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span><span class="o">.</span><span class="n">rotate_z</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TS</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_patched</span>

<div class="viewcode-block" id="PolarMagnet.plot"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnet.html#zgoubidoo.commands.magnetique.PolarMagnet.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artist</span><span class="p">:</span> <span class="n">_ZgoubiPlot</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            artist:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">PolarMagnet</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">())(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolarMagnet.plot_tracks"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnet.html#zgoubidoo.commands.magnetique.PolarMagnet.plot_tracks">[docs]</a>    <span class="k">def</span> <span class="nf">plot_tracks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            artist:</span>
<span class="sd">            tracks:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">artist</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">tracks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">f</span><span class="s2">&quot;tracks_{PolarMagnet.__name__.lower()}&quot;</span><span class="p">)(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tracks</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolarMagnet.drift_length_from_polar"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnet.html#zgoubidoo.commands.magnetique.PolarMagnet.drift_length_from_polar">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">drift_length_from_polar</span><span class="p">(</span><span class="n">radius</span><span class="p">:</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">magnet_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">poles_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            radius: the reference radius of the magnet</span>
<span class="sd">            magnet_angle: total angular opening of the magnet (i.e. of the field-map)</span>
<span class="sd">            poles_angle: angular opening of the poles</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">tan</span><span class="p">(((</span><span class="n">magnet_angle</span> <span class="o">-</span> <span class="n">poles_angle</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;radian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolarMagnet.efb_offset_from_polar"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnet.html#zgoubidoo.commands.magnetique.PolarMagnet.efb_offset_from_polar">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">efb_offset_from_polar</span><span class="p">(</span><span class="n">radius</span><span class="p">:</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">magnet_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">poles_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            radius: the reference radius of the magnet</span>
<span class="sd">            magnet_angle: total angular opening of the magnet (i.e. of the field-map)</span>
<span class="sd">            poles_angle: angular opening of the poles</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">radius</span> <span class="o">/</span> <span class="n">_np</span><span class="o">.</span><span class="n">cos</span><span class="p">(((</span><span class="n">magnet_angle</span> <span class="o">-</span> <span class="n">poles_angle</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;radian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolarMagnet.efb_angle_from_polar"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PolarMagnet.html#zgoubidoo.commands.magnetique.PolarMagnet.efb_angle_from_polar">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">efb_angle_from_polar</span><span class="p">(</span><span class="n">magnet_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">,</span> <span class="n">poles_angle</span><span class="p">:</span> <span class="n">_Q</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Q</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            magnet_angle: total angular opening of the magnet (i.e. of the field-map)</span>
<span class="sd">            poles_angle: angular opening of the poles</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">magnet_angle</span> <span class="o">-</span> <span class="n">poles_angle</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span></div></div>


<div class="viewcode-block" id="AGSMainMagnet"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.AGSMainMagnet.html#zgoubidoo.commands.magnetique.AGSMainMagnet">[docs]</a><span class="k">class</span> <span class="nc">AGSMainMagnet</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;AGS main magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;AGSMM&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="AGSQuadrupole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.AGSQuadrupole.html#zgoubidoo.commands.magnetique.AGSQuadrupole">[docs]</a><span class="k">class</span> <span class="nc">AGSQuadrupole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;AGS quadrupole.</span>

<span class="sd">    The AGS quadrupoles are regular quadrupoles. The simulation of AGSQUAD uses the same field mod- elling as MULTIPOL,</span>
<span class="sd">    section 1.3.7, page 25. However amperes are provided as input to AGSQUAD rather than fields, the reason being that</span>
<span class="sd">    some of the AGS quadrupoles have two superimposed coil circuits, with separate power supplies. It has been dealt</span>
<span class="sd">    with this particularity by allowing for an additional set of multi- pole data in AGSQUAD, compared to MULTIPOL.</span>

<span class="sd">    The field in AGSQUAD is computed using transfer functions from the ampere-turns in the coils to magnetic field that</span>
<span class="sd">    account for the non-linearity of the magnetic permeability [33].</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;AGSQUAD&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>

    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Aimant"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Aimant.html#zgoubidoo.commands.magnetique.Aimant">[docs]</a><span class="k">class</span> <span class="nc">Aimant</span><span class="p">(</span><span class="n">PolarMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generation of dipole mid-plane 2-D map, polar frame.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;AIMANT&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;NFACE&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;IC&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># 1, 2: print field map</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># 1, 2: print field and coordinates on trajectores</span>
        <span class="s1">&#39;IAMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;IRMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;ACENT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RMIN&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_E&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_S&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;LAM_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;RM3&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NBS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DELTAB&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;IORDRE&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DP&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIM_R1&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_R2&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_THETA1&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_THETA2&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_LAMBDA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_GAMMA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_ALPHA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_BETA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_MU&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NFACE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Error : Zgoubido does not support NFACE = </span><span class="si">{s.NFACE}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                {super().__str__().rstrip()}</span>
<span class="s2">                </span><span class="si">{s.NFACE}</span><span class="s2"> </span><span class="si">{s.IC}</span><span class="s2"> </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.IAMAX}</span><span class="s2"> </span><span class="si">{s.IRMAX}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.B0:.12e}</span><span class="s2"> </span><span class="si">{s.N:.12e}</span><span class="s2"> </span><span class="si">{s.B:.12e}</span><span class="s2"> </span><span class="si">{s.G:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.AT:.12e}</span><span class="s2"> </span><span class="si">{s.ACENT:.12e}</span><span class="s2"> </span><span class="si">{s.RM:.12e}</span><span class="s2"> </span><span class="si">{s.RMIN:.12e}</span><span class="s2"> </span><span class="si">{s.RMAX:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.LAM_E:.12e}</span><span class="s2"> </span><span class="si">{s.XI_E:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.NCE}</span><span class="s2"> </span><span class="si">{s.C0_E:.12e}</span><span class="s2"> </span><span class="si">{s.C1_E:.12e}</span><span class="s2"> </span><span class="si">{s.C2_E:.12e}</span><span class="s2"> </span><span class="si">{s.C3_E:.12e}</span><span class="s2"> </span><span class="si">{s.C4_E:.12e}</span><span class="s2"> </span><span class="si">{s.C5_E:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_E:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.OMEGA_E:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_E:.12e}</span><span class="s2"> </span><span class="si">{s.R1_E:.12e}</span><span class="s2"> </span><span class="si">{s.U1_E:.12e}</span><span class="s2"> </span><span class="si">{s.U2_E:.12e}</span><span class="s2"> </span><span class="si">{s.R2_E:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.LAM_S:.12e}</span><span class="s2"> </span><span class="si">{s.XI_S:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.NCS}</span><span class="s2"> </span><span class="si">{s.C0_S:.12e}</span><span class="s2"> </span><span class="si">{s.C1_S:.12e}</span><span class="s2"> </span><span class="si">{s.C2_S:.12e}</span><span class="s2"> </span><span class="si">{s.C3_S:.12e}</span><span class="s2"> </span><span class="si">{s.C4_S:.12e}</span><span class="s2"> </span><span class="si">{s.C5_S:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_S:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.OMEGA_S:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_S:.12e}</span><span class="s2"> </span><span class="si">{s.R1_S:.12e}</span><span class="s2"> </span><span class="si">{s.U1_S:.12e}</span><span class="s2"> </span><span class="si">{s.U2_S:.12e}</span><span class="s2"> </span><span class="si">{s.R2_S:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NFACE</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{s.LAM_L:.12e}</span><span class="s2"> </span><span class="si">{s.XI_L:.12e}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{s.NCL}</span><span class="s2"> </span><span class="si">{s.C0_L:.12e}</span><span class="s2"> </span><span class="si">{s.C1_L:.12e}</span><span class="s2"> </span><span class="si">{s.C2_L:.12e}</span><span class="s2"> </span><span class="si">{s.C3_L:.12e}</span><span class="s2"> </span><span class="si">{s.C4_L:.12e}</span><span class="s2"> </span><span class="si">{s.C5_L:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_L:.12e}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{s.OMEGA_L:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_L:.12e}</span><span class="s2"> </span><span class="si">{s.R1_L:.12e}</span><span class="s2"> </span><span class="si">{s.U1_L:.12e}</span><span class="s2"> </span><span class="si">{s.U2_L:.12e}</span><span class="s2"> </span><span class="si">{s.R2_L:.12e}</span><span class="s2"> </span><span class="si">{s.RM3:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.NBS}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{s.NBS}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{s.R0:.12e}</span><span class="s2"> </span><span class="si">{s.DELTAB:.12e}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{s.NBS}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{s.THETA_0:.12e}</span><span class="s2"> </span><span class="si">{s.DELTAB:.12e}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.NBS}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

            <span class="n">shim_r1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R1</span><span class="p">)</span>
            <span class="n">shim_r2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R2</span><span class="p">)</span>
            <span class="n">shim_theta1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA1</span><span class="p">)</span>
            <span class="n">shim_theta2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA2</span><span class="p">)</span>
            <span class="n">shim_lambda</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_LAMBDA</span><span class="p">)</span>
            <span class="n">shim_gamma</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_GAMMA</span><span class="p">)</span>
            <span class="n">shim_alpha</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_ALPHA</span><span class="p">)</span>
            <span class="n">shim_beta</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_BETA</span><span class="p">)</span>
            <span class="n">shim_mu</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_MU</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">shim_r1</span> \
                    <span class="o">==</span> <span class="n">shim_r2</span> \
                    <span class="o">==</span> <span class="n">shim_theta1</span> \
                    <span class="o">==</span> <span class="n">shim_theta2</span> \
                    <span class="o">==</span> <span class="n">shim_lambda</span> \
                    <span class="o">==</span> <span class="n">shim_gamma</span> \
                    <span class="o">==</span> <span class="n">shim_alpha</span> \
                    <span class="o">==</span> <span class="n">shim_beta</span> \
                    <span class="o">==</span> <span class="n">shim_mu</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R1</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_R2</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA1</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_LAMBDA</span><span class="p">):</span>
                    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        </span><span class="si">{i:.12e}</span><span class="s2"> </span><span class="si">{j:.12e}</span><span class="s2"> </span><span class="si">{k:.12e}</span><span class="s2"> </span><span class="si">{l:.12e}</span><span class="s2"></span>
<span class="s2">                        &quot;&quot;&quot;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">GAMMA</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">MU</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">BETA</span><span class="p">):</span>
                    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                                       </span><span class="si">{i:.12e}</span><span class="s2"> </span><span class="si">{j:.12e}</span><span class="s2"> </span><span class="si">{k:.12e}</span><span class="s2"> </span><span class="si">{l:.12e}</span><span class="s2"></span>
<span class="s2">                                       &quot;&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s1">&#39;Error : The shim parameters lists must have the same lenghts&#39;</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.IORDRE}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.XPAS:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{s.RE:.12e}</span><span class="s2"> </span><span class="si">{s.TE:.12e}</span><span class="s2"> </span><span class="si">{s.RS:.12e}</span><span class="s2"> </span><span class="si">{s.TS:.12e}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{s.DP:.12e}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Bend"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Bend.html#zgoubidoo.commands.magnetique.Bend">[docs]</a><span class="k">class</span> <span class="nc">Bend</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Bending magnet, Cartesian frame.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;BEND&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Print field and coordinates along trajectories&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Magnet length (straight reference frame)&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;SK&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s2">&quot;Skew angle&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="s1">&#39;B1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s2">&quot;Dipole field&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Integration zone extension (entrance face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Fringe field extension (entrance face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;W_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s2">&quot;Wedge angle (entrance face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Integration zone extension (exit face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s2">&quot;Fringe field extension (exit face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;W_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s2">&quot;Wedge angle (exit face)&quot;</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">millimeter</span><span class="p">,</span> <span class="s2">&quot;Integration step&quot;</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Alignment parameter&quot;</span><span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        {super().__str__().rstrip()}</span>
<span class="s2">        {int(s.IL):d}</span>
<span class="s2">        {s.XL.to(&#39;cm&#39;).magnitude:.12e} {s.SK.to(&#39;radian&#39;).magnitude:.12e} {_kilogauss(s.B1):.12e}</span>
<span class="s2">        {s.X_E.to(&#39;cm&#39;).magnitude:.12e} {s.LAM_E.to(&#39;cm&#39;).magnitude:.12e} {s.W_E.to(&#39;radian&#39;).magnitude:.12e}</span>
<span class="s2">        6 </span><span class="si">{s.C0_E:.12e}</span><span class="s2"> </span><span class="si">{s.C1_E:.12e}</span><span class="s2"> </span><span class="si">{s.C2_E:.12e}</span><span class="s2"> </span><span class="si">{s.C3_E:.12e}</span><span class="s2"> </span><span class="si">{s.C4_E:.12e}</span><span class="s2"> </span><span class="si">{s.C5_E:.12e}</span><span class="s2"></span>
<span class="s2">        {s.X_S.to(&#39;cm&#39;).magnitude:.12e} {s.LAM_S.to(&#39;cm&#39;).magnitude:.12e} {s.W_S.to(&#39;radian&#39;).magnitude:.12e}</span>
<span class="s2">        6 </span><span class="si">{s.C0_S:.12e}</span><span class="s2"> </span><span class="si">{s.C1_S:.12e}</span><span class="s2"> </span><span class="si">{s.C2_S:.12e}</span><span class="s2"> </span><span class="si">{s.C3_S:.12e}</span><span class="s2"> </span><span class="si">{s.C4_S:.12e}</span><span class="s2"> </span><span class="si">{s.C5_S:.12e}</span><span class="s2"></span>
<span class="s2">        {_cm(s.XPAS):.12e}</span>
<span class="s2">        {int(s.KPOS):d} {_cm(s.XCE):.12e} {_cm(s.YCE):.12e} {_radian(s.ALE):.12e}</span>
<span class="s2">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="FakeDrift"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.FakeDrift.html#zgoubidoo.commands.magnetique.FakeDrift">[docs]</a><span class="k">class</span> <span class="nc">FakeDrift</span><span class="p">(</span><span class="n">Bend</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A fake drift (bend with almost vanishing field) to allow plotting trajectories through drift spaces.&quot;&quot;&quot;</span>
    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;B1&#39;</span><span class="p">:</span> <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">gauss</span><span class="p">,</span>
        <span class="s1">&#39;COLOR&#39;</span><span class="p">:</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Decapole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Decapole.html#zgoubidoo.commands.magnetique.Decapole">[docs]</a><span class="k">class</span> <span class="nc">Decapole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Decapole magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DECAPOLE&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span>
        <span class="s1">&#39;XE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;C0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;C2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XS&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">        commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        {super().__str__().rstrip()}</span>
<span class="s2">        {int(s.IL):d}</span>
<span class="s2">        {_cm(s.XL):.12e} {_cm(s.R0):.12e} {_kilogauss(s.B0):.12e}</span>
<span class="s2">        {_cm(s.XE):.12e} {_cm(s.LAM_E):.12e}</span>
<span class="s2">        6 </span><span class="si">{s.C0:.12e}</span><span class="s2"> </span><span class="si">{s.C1:.12e}</span><span class="s2"> </span><span class="si">{s.C2:.12e}</span><span class="s2"> </span><span class="si">{s.C3:.12e}</span><span class="s2"> </span><span class="si">{s.C4:.12e}</span><span class="s2"> </span><span class="si">{s.C5:.12e}</span><span class="s2"></span>
<span class="s2">        {_cm(s.XS):.12e} {_cm(s.LAM_S):.12e}</span>
<span class="s2">        6 </span><span class="si">{s.C0:.12e}</span><span class="s2"> </span><span class="si">{s.C1:.12e}</span><span class="s2"> </span><span class="si">{s.C2:.12e}</span><span class="s2"> </span><span class="si">{s.C3:.12e}</span><span class="s2"> </span><span class="si">{s.C4:.12e}</span><span class="s2"> </span><span class="si">{s.C5:.12e}</span><span class="s2"></span>
<span class="s2">        {_cm(s.XPAS)}</span>
<span class="s2">        {int(s.KPOS):d} {_cm(s.XCE):.12e} {_cm(s.YCE):.12e} {_radian(s.ALE):.12e}</span>
<span class="s2">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Dipole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Dipole.html#zgoubidoo.commands.magnetique.Dipole">[docs]</a><span class="k">class</span> <span class="nc">Dipole</span><span class="p">(</span><span class="n">PolarMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dipole magnet, polar frame.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    ``DIPOLE`` provides a model of a dipole field, possibly with transverse field indices. The field along a particle</span>
<span class="sd">    trajectory is computed as the particle motion proceeds, straightforwardly from the dipole geometrical boundaries.</span>
<span class="sd">    Field simulation in ``DIPOLE`` is the same as used in ``DIPOLE-M`` and ``AIMANT`` for computing a field map;</span>
<span class="sd">    the essential difference in ``DIPOLE`` is in its skipping that intermediate stage of field map generation found in</span>
<span class="sd">    ``DIPOLE-M`` and ``AIMANT``.</span>

<span class="sd">    ``DIPOLE`` has a version, ``DIPOLES``, that allows overlapping of fringe fields in a configuration of neighboring</span>
<span class="sd">    magnets.</span>

<span class="sd">    The dimensioning of the magnet is defined by (Fig. 11, p. 82):</span>

<span class="sd">        - AT : total angular aperture</span>
<span class="sd">        - RM : mean radius used for the positioning of field boundaries</span>

<span class="sd">    The 2 or 3 effective field boundaries (EFB), from which the dipole field is drawn, are defined from geometric</span>
<span class="sd">    boundaries, the shape and position of which are determined by the following parameters:</span>

<span class="sd">        - ACENT: arbitrary inner angle, used for EFB’s positioning;</span>
<span class="sd">        - ω: azimuth of an EFB with respect to ACENT;</span>
<span class="sd">        - θ: angle of an EFB with respect to its azimuth (wedge angle) : radius of curvature of an EFB;</span>
<span class="sd">        - R1, R2 U1, U2: extent of the linear part of an EFB.</span>

<span class="sd">    The magnetic field is calculated in polar coordinates. At any position (R, θ) along the particle trajectory the</span>
<span class="sd">    value of the vertical component of the mid-plane field is calculated using</span>

<span class="sd">    R−RM􏰖 􏰕R−RM􏰖2 􏰕R−RM􏰖3􏰛 BZ(R,θ)=F(R,θ)∗B0∗ 1+N∗ RM +B∗ RM +G∗ RM (4.4.8)</span>

<span class="sd">    where N, B and G are respectively the first, second and third order field indices and F(R,θ) is the fringe field</span>
<span class="sd">    coefficient (it determines the “flutter” in periodic structures).</span>

<span class="sd">    Calculation of the Fringe Field Coefficient</span>

<span class="sd">    With each EFB a realistic extent of the fringe field, λ (normally equal to the gap size), is associated and a</span>
<span class="sd">    fringe field coefficient F is calculated. In the following λ stands for either λE (Entrance), λS (Exit)</span>
<span class="sd">    or λL (Lateral EFB).</span>

<span class="sd">    F is an exponential type fringe field (Fig. 12, p. 84) given by [34] F=1</span>
<span class="sd">    1+expP(s) wherein s is the distance to the EFB and depends on (R, θ), and</span>
<span class="sd">    P(s)=C0 +C1􏰓s􏰔+C2􏰓s􏰔2 +C3􏰓s􏰔3 +C4􏰓s􏰔4 +C5􏰓s􏰔5 λλλλλ</span>
<span class="sd">    It is also possible to simulate a shift of the EFB, by giving a non zero value to the parameter shift. s is then changed to s−shift in the previous equation. This allows small variations of the magnetic length.</span>
<span class="sd">    Let FE (respectively FS , FL) be the fringe field coefficient attached to the entrance (respectively exit, lateral) EFB. At any position on a trajectory the resulting value of the fringe field coefficient (eq. 4.4.8) is</span>

<span class="sd">    102 4 DESCRIPTION OF THE AVAILABLE PROCEDURES</span>
<span class="sd">    F(R,θ)=FE ∗FS ∗FL In particular, FL ≡ 1 if no lateral EFB is requested.</span>
<span class="sd">    Calculation of the Mid-plane Field and Derivatives</span>
<span class="sd">    BZ (R, θ) in Eq. 4.4.8 is computed at the n × n nodes (n = 3 or 5 in practice) of a “flying” interpolation grid in the median plane centered on the projection m0 of the actual particle position M0 as schemed in Fig. 20. A polynomial interpolation is involved, of the form</span>
<span class="sd">    BZ(R,θ)=A00 +A10θ+A01R+A20θ2 +A11θR+A02R2 that yields the requested derivatives, using</span>
<span class="sd">    Akl = 1 ∂k+lBZ k!l! ∂θk∂rl</span>
<span class="sd">    Note that, the source code contains the explicit analytical expressions of the coefficients Akl solutions of the normal equations, so that the operation is not CPU time consuming.</span>
<span class="sd">    B2</span>
<span class="sd">    interpolation</span>
<span class="sd">    grid δ s particle</span>
<span class="sd">    trajectory B1mm1 B3</span>
<span class="sd">    0</span>
<span class="sd">    Figure 20: Interpolation method. m0 and m1 are the projections in the median plane of particle positions M0 and M1 and separated by δs, projection of the integration step.</span>
<span class="sd">    Extrapolation Off Median Plane</span>
<span class="sd">    From the vertical field B⃗ and derivatives in the median plane, first a transformation from polar to Cartesian coordinates is performed, following eqs (1.4.9 or 1.4.10), then, extrapolation off median plane is performed by means of Taylor expansions, following the procedure described in section 1.3.3.</span>

<span class="sd">    .. rubric:: Zgoubidoo usage and example</span>

<span class="sd">    &gt;&gt;&gt; m = Dipole()</span>
<span class="sd">    &gt;&gt;&gt; m.fit()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DIPOLE&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Total angular extent of the dipole&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Reference radius&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="s1">&#39;ACENT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;Azimuth for positioning of EFBs&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Reference field&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Field index (radial quadrupolar)&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
        <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Field index (radial sextupolar)&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
        <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Field index (radial octupolar)&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance fringe field extent (normally ≃ gap size)&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span>
        <span class="s1">&#39;THETA_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;R1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB radius&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
        <span class="s1">&#39;U1_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span>
        <span class="s1">&#39;U2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span>
        <span class="s1">&#39;R2_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance EFB radius&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit fringe field extent (normally ≃ gap size)&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span>
        <span class="s1">&#39;THETA_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
        <span class="s1">&#39;R1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB radius&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
        <span class="s1">&#39;U1_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="s1">&#39;U2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">37</span><span class="p">),</span>
        <span class="s1">&#39;R2_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit EFB radius&#39;</span><span class="p">,</span> <span class="mi">38</span><span class="p">),</span>
        <span class="s1">&#39;LAM_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Lateral fringe field extent (normally ≃ gap size)&#39;</span><span class="p">,</span> <span class="mi">39</span><span class="p">),</span>
        <span class="s1">&#39;XI_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Flag to activate/deactivate the lateral EFB (0 to deactivate)&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
        <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C0&#39;</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span>
        <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C1&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span>
        <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C2&#39;</span><span class="p">,</span> <span class="mi">43</span><span class="p">),</span>
        <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C3&#39;</span><span class="p">,</span> <span class="mi">44</span><span class="p">),</span>
        <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C4&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span>
        <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Fringe field coefficient C5&#39;</span><span class="p">,</span> <span class="mi">46</span><span class="p">),</span>
        <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Shift of the EFB&#39;</span><span class="p">,</span> <span class="mi">47</span><span class="p">),</span>
        <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span>
        <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">49</span><span class="p">),</span>
        <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Lateral EFB radius&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Lateral EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
        <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Lateral EFB linear extent&#39;</span><span class="p">,</span> <span class="mi">52</span><span class="p">),</span>
        <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Lateral EFB radius&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="p">),</span>
        <span class="s1">&#39;RM3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Reference radius of the lateral EFB&#39;</span><span class="p">,</span> <span class="mi">54</span><span class="p">),</span>
        <span class="s1">&#39;IORDRE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span>
        <span class="s1">&#39;RESOL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">millimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">,</span> <span class="mi">57</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span>
        <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
        <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
        <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">61</span><span class="p">),</span>
        <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">62</span><span class="p">),</span>
        <span class="s1">&#39;DP&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">63</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Dipole.post_init"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Dipole.html#zgoubidoo.commands.magnetique.Dipole.post_init">[docs]</a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NoReturn</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_E</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_E</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_S</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OMEGA_S</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ACENT</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ACENT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AT</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RE</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span>
        <span class="k">if</span> <span class="n">_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RS</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        {super().__str__().rstrip()}</span>
<span class="s2">        </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">        {_degree(s.AT):.12e} {_cm(s.RM):.12e}</span>
<span class="s2">        {_degree(s.ACENT):.12e} {_kilogauss(s.B0):.12e} </span><span class="si">{s.N:.12e}</span><span class="s2"> </span><span class="si">{s.B:.12e}</span><span class="s2"> </span><span class="si">{s.G:.12e}</span><span class="s2"></span>
<span class="s2">        {_cm(s.LAM_E):.12e} -1.0</span>
<span class="s2">        6 </span><span class="si">{s.C0_E:.12e}</span><span class="s2"> </span><span class="si">{s.C1_E:.12e}</span><span class="s2"> </span><span class="si">{s.C2_E:.12e}</span><span class="s2"> </span><span class="si">{s.C3_E:.12e}</span><span class="s2"> </span><span class="si">{s.C4_E:.12e}</span><span class="s2"> </span><span class="si">{s.C5_E:.12e}</span><span class="s2"> {_cm(s.SHIFT_E):.12e}</span>
<span class="s2">        {_degree(s.OMEGA_E):.12e} </span><span class="si">{s.THETA_E:.12e}</span><span class="s2"> {_cm(s.R1_E):.12e} {_cm(s.U1_E):.12e} {_cm(s.U2_E):.12e} {_cm(s.R2_E):.12e}</span>
<span class="s2">        {_cm(s.LAM_S):.12e} -1.0</span>
<span class="s2">        6 </span><span class="si">{s.C0_S:.12e}</span><span class="s2"> </span><span class="si">{s.C1_S:.12e}</span><span class="s2"> </span><span class="si">{s.C2_S:.12e}</span><span class="s2"> </span><span class="si">{s.C3_S:.12e}</span><span class="s2"> </span><span class="si">{s.C4_S:.12e}</span><span class="s2"> </span><span class="si">{s.C5_S:.12e}</span><span class="s2"> {_cm(s.SHIFT_S):.12e}</span>
<span class="s2">        {_degree(s.OMEGA_S):.12e} </span><span class="si">{s.THETA_S:.12e}</span><span class="s2"> {_cm(s.R1_S):.12e} {_cm(s.U1_S):.12e} {_cm(s.U2_S):.12e} {_cm(s.R2_S):.12e}</span>
<span class="s2">        {_cm(s.LAM_L):.12e} </span><span class="si">{s.XI_L}</span><span class="s2"></span>
<span class="s2">        6 </span><span class="si">{s.C0_L:.12e}</span><span class="s2"> </span><span class="si">{s.C1_L:.12e}</span><span class="s2"> </span><span class="si">{s.C2_L:.12e}</span><span class="s2"> </span><span class="si">{s.C3_L:.12e}</span><span class="s2"> </span><span class="si">{s.C4_L:.12e}</span><span class="s2"> </span><span class="si">{s.C5_L:.12e}</span><span class="s2"> {_cm(s.SHIFT_L):.12e}</span>
<span class="s2">        {_degree(s.OMEGA_L):.12e} </span><span class="si">{s.THETA_L:.12e}</span><span class="s2"> {_cm(s.R1_L):.12e} {_cm(s.U1_L):.12e} {_cm(s.U2_L):.12e} {_cm(s.R2_L):.12e} {_cm(s.RM3):.12e}</span>
<span class="s2">        </span><span class="si">{s.IORDRE}</span><span class="s2"> </span><span class="si">{s.RESOL:.12e}</span><span class="s2"></span>
<span class="s2">        {_cm(s.XPAS)}&quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">        {_cm(s.RE):.12e} {_radian(s.TE):.12e} {_cm(s.RS):.12e} {_radian(s.TS):.12e}</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{s.DP:.12e}</span><span class="s2"> 0.0 0.0 0.0</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span>

<div class="viewcode-block" id="Dipole.fit"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Dipole.html#zgoubidoo.commands.magnetique.Dipole.fit">[docs]</a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">boro</span><span class="p">:</span> <span class="n">_Q</span><span class="p">,</span>
            <span class="n">particle</span><span class="p">:</span> <span class="n">_ParticuleType</span> <span class="o">=</span> <span class="n">_Proton</span><span class="p">,</span>
            <span class="n">entry_coordinates</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">exit_coordinates</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="n">method</span><span class="p">:</span> <span class="n">_FitType</span> <span class="o">=</span> <span class="n">_Fit2</span><span class="p">,</span>
            <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            boro:</span>
<span class="sd">            particle:</span>
<span class="sd">            entry_coordinates:</span>
<span class="sd">            exit_coordinates:</span>
<span class="sd">            method:</span>
<span class="sd">            debug:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">entry_coordinates</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">entry_coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>

        <span class="n">z</span> <span class="o">=</span> <span class="n">zgoubidoo</span><span class="o">.</span><span class="n">Zgoubi</span><span class="p">()</span>
        <span class="n">di</span> <span class="o">=</span> <span class="n">zgoubidoo</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;FIT_</span><span class="si">{self.LABEL1}</span><span class="s2">_MAGNET&quot;</span><span class="p">)</span>
        <span class="n">di</span> <span class="o">+=</span> <span class="n">_Objet2</span><span class="p">(</span><span class="s1">&#39;BUNCH&#39;</span><span class="p">,</span> <span class="n">BORO</span><span class="o">=</span><span class="n">boro</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">entry_coordinates</span><span class="p">])</span>
        <span class="n">di</span> <span class="o">+=</span> <span class="n">particle</span><span class="p">()</span>
        <span class="n">di</span> <span class="o">+=</span> <span class="n">_Marker</span><span class="p">(</span><span class="s1">&#39;START&#39;</span><span class="p">)</span>
        <span class="n">di</span> <span class="o">+=</span> <span class="bp">self</span>
        <span class="n">di</span> <span class="o">+=</span> <span class="n">_Marker</span><span class="p">(</span><span class="s1">&#39;END&#39;</span><span class="p">)</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="s1">&#39;FIT&#39;</span><span class="p">,</span>
                     <span class="n">PENALTY</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span>
                     <span class="n">PARAMS</span><span class="o">=</span><span class="p">[</span>
                         <span class="p">{</span>
                             <span class="s1">&#39;IR&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>  <span class="c1"># B1</span>
                             <span class="s1">&#39;IP&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                             <span class="s1">&#39;XC&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                             <span class="s1">&#39;DV&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                         <span class="p">},</span>
                     <span class="p">],</span>
                     <span class="n">CONSTRAINTS</span><span class="o">=</span><span class="p">[</span>
                         <span class="p">{</span>
                             <span class="s1">&#39;IC&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1"># Constraint type</span>
                             <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Particle #1</span>
                             <span class="s1">&#39;J&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Y</span>
                             <span class="s1">&#39;IR&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># END</span>
                             <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="n">exit_coordinates</span><span class="p">,</span>
                             <span class="s1">&#39;WV&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                             <span class="s1">&#39;NP&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="p">},</span>
                     <span class="p">]</span>
                     <span class="p">)</span>
        <span class="n">di</span> <span class="o">+=</span> <span class="n">fit</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">z</span><span class="p">(</span><span class="n">di</span><span class="p">())</span>  <span class="c1"># Run Zgoubi</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;result&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">fit</span><span class="o">.</span><span class="n">results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Unable to fit </span><span class="si">{self.__class__.__name__}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B0</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;final&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fit</span> <span class="o">=</span> <span class="n">fit</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>


<div class="viewcode-block" id="DipoleM"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.DipoleM.html#zgoubidoo.commands.magnetique.DipoleM">[docs]</a><span class="k">class</span> <span class="nc">DipoleM</span><span class="p">(</span><span class="n">PolarMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;TODO.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DIPOLE-M&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;NFACE&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;IC&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># 1, 2: print field map</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># 1, 2: print field and coordinates on trajectores</span>
        <span class="s1">&#39;IAMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;IRMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;ACENT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RMIN&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RMAX&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_E&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_E&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_S&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_S&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;LAM_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XI_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;RM3&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NBS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DELTAB&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;THETA_0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;IORDRE&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DP&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;SHIM_R1&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_R2&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_THETA1&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_THETA2&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_LAMBDA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_GAMMA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_ALPHA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_BETA&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;SHIM_MU&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NFACE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Error : Zgoubido does not support NFACE = </span><span class="si">{s.NFACE}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            {super().__str__().rstrip()}</span>
<span class="s2">            </span><span class="si">{s.NFACE}</span><span class="s2"> </span><span class="si">{s.IC}</span><span class="s2"> </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.IAMAX}</span><span class="s2"> </span><span class="si">{s.IRMAX}</span><span class="s2"></span>
<span class="s2">            {s.B0.to(&#39;kilogauss&#39;).magnitude:.12e} </span><span class="si">{s.N:.12e}</span><span class="s2"> </span><span class="si">{s.B:.12e}</span><span class="s2"> </span><span class="si">{s.G:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.AT:.12e}</span><span class="s2"> </span><span class="si">{s.ACENT:.12e}</span><span class="s2"> </span><span class="si">{s.RM:.12e}</span><span class="s2"> </span><span class="si">{s.RMIN:.12e}</span><span class="s2"> </span><span class="si">{s.RMAX:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.LAM_E:.12e}</span><span class="s2"> </span><span class="si">{s.XI_E:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.NCE}</span><span class="s2"> </span><span class="si">{s.C0_E:.12e}</span><span class="s2"> </span><span class="si">{s.C1_E:.12e}</span><span class="s2"> </span><span class="si">{s.C2_E:.12e}</span><span class="s2"> </span><span class="si">{s.C3_E:.12e}</span><span class="s2"> </span><span class="si">{s.C4_E:.12e}</span><span class="s2"> </span><span class="si">{s.C5_E:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_E:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.OMEGA_E:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_E:.12e}</span><span class="s2"> </span><span class="si">{s.R1_E:.12e}</span><span class="s2"> </span><span class="si">{s.U1_E:.12e}</span><span class="s2"> </span><span class="si">{s.U2_E:.12e}</span><span class="s2"> </span><span class="si">{s.R2_E:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.LAM_S:.12e}</span><span class="s2"> </span><span class="si">{s.XI_S:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.NCS}</span><span class="s2"> </span><span class="si">{s.C0_S:.12e}</span><span class="s2"> </span><span class="si">{s.C1_S:.12e}</span><span class="s2"> </span><span class="si">{s.C2_S:.12e}</span><span class="s2"> </span><span class="si">{s.C3_S:.12e}</span><span class="s2"> </span><span class="si">{s.C4_S:.12e}</span><span class="s2"> </span><span class="si">{s.C5_S:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_S:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.OMEGA_S:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_S:.12e}</span><span class="s2"> </span><span class="si">{s.R1_S:.12e}</span><span class="s2"> </span><span class="si">{s.U1_S:.12e}</span><span class="s2"> </span><span class="si">{s.U2_S:.12e}</span><span class="s2"> </span><span class="si">{s.R2_S:.12e}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NFACE</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.LAM_L:.12e}</span><span class="s2"> </span><span class="si">{s.XI_L:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.NCL}</span><span class="s2"> </span><span class="si">{s.C0_L:.12e}</span><span class="s2"> </span><span class="si">{s.C1_L:.12e}</span><span class="s2"> </span><span class="si">{s.C2_L:.12e}</span><span class="s2"> </span><span class="si">{s.C3_L:.12e}</span><span class="s2"> </span><span class="si">{s.C4_L:.12e}</span><span class="s2"> </span><span class="si">{s.C5_L:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_L:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.OMEGA_L:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_L:.12e}</span><span class="s2"> </span><span class="si">{s.R1_L:.12e}</span><span class="s2"> </span><span class="si">{s.U1_L:.12e}</span><span class="s2"> </span><span class="si">{s.U2_L:.12e}</span><span class="s2"> </span><span class="si">{s.R2_L:.12e}</span><span class="s2"> </span><span class="si">{s.RM3:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.NBS}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.NBS}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.R0:.12e}</span><span class="s2"> </span><span class="si">{s.DELTAB:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.NBS}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.THETA_0:.12e}</span><span class="s2"> </span><span class="si">{s.DELTAB:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">NBS</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.NBS}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

            <span class="n">shim_r1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R1</span><span class="p">)</span>
            <span class="n">shim_r2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R2</span><span class="p">)</span>
            <span class="n">shim_theta1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA1</span><span class="p">)</span>
            <span class="n">shim_theta2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA2</span><span class="p">)</span>
            <span class="n">shim_lambda</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_LAMBDA</span><span class="p">)</span>
            <span class="n">shim_gamma</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_GAMMA</span><span class="p">)</span>
            <span class="n">shim_alpha</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_ALPHA</span><span class="p">)</span>
            <span class="n">shim_beta</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_BETA</span><span class="p">)</span>
            <span class="n">shim_mu</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_MU</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">shim_r1</span>\
                    <span class="o">==</span> <span class="n">shim_r2</span> \
                    <span class="o">==</span> <span class="n">shim_theta1</span> \
                    <span class="o">==</span> <span class="n">shim_theta2</span> \
                    <span class="o">==</span> <span class="n">shim_lambda</span> \
                    <span class="o">==</span> <span class="n">shim_gamma</span> \
                    <span class="o">==</span> <span class="n">shim_alpha</span> \
                    <span class="o">==</span> <span class="n">shim_beta</span> \
                    <span class="o">==</span> <span class="n">shim_mu</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">SHIM_R1</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_R2</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_THETA1</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">SHIM_LAMBDA</span><span class="p">):</span>
                    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{i:.12e}</span><span class="s2"> </span><span class="si">{j:.12e}</span><span class="s2"> </span><span class="si">{k:.12e}</span><span class="s2"> </span><span class="si">{l:.12e}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">GAMMA</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">MU</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">BETA</span><span class="p">):</span>
                    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                                   </span><span class="si">{i:.12e}</span><span class="s2"> </span><span class="si">{j:.12e}</span><span class="s2"> </span><span class="si">{k:.12e}</span><span class="s2"> </span><span class="si">{l:.12e}</span><span class="s2"></span>
<span class="s2">                                   &quot;&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s1">&#39;Error : The shim parameters lists must have the same lenghts&#39;</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.IORDRE}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.XPAS:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.RE:.12e}</span><span class="s2"> </span><span class="si">{s.TE:.12e}</span><span class="s2"> </span><span class="si">{s.RS:.12e}</span><span class="s2"> </span><span class="si">{s.TS:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.DP:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Dipoles"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Dipoles.html#zgoubidoo.commands.magnetique.Dipoles">[docs]</a><span class="k">class</span> <span class="nc">Dipoles</span><span class="p">(</span><span class="n">PolarMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dipole magnet N-tuple, polar frame.</span>

<span class="sd">    .. rubric:: Zgoubi manual description</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DIPOLES&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>

        <span class="s1">&#39;ACN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;DELTA_RM&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;IND&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;BI&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span> <span class="p">],</span>
        <span class="s1">&#39;G0_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;K_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;THETA_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;R1_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;U1_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;U2_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;R2_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;G0_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;K_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;THETA_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;R1_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;U1_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;U2_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;R2_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;G0_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;K_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;NCL&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;R3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>

        <span class="s1">&#39;KIRD&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;Resol&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DP&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        {super().__str__().rstrip()}</span>
<span class="s2">        </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{s.N}</span><span class="s2"> </span><span class="si">{s.AT:.12e}</span><span class="s2"> </span><span class="si">{s.RM:.12e}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="p">)):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;</span><span class="si">{s.ACN[i]:.12e}</span><span class="s2"> </span><span class="si">{s.DELTA_RM[i]:.12e}</span><span class="s2"> </span><span class="si">{s.B0[i]:.12e}</span><span class="s2"> </span><span class="si">{s.IND[i]}</span><span class="s2"> &quot;</span>
            <span class="k">for</span> <span class="n">bi</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">BI</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">c</span> <span class="o">+=</span> <span class="n">f</span><span class="s2">&quot;</span><span class="si">{bi}</span><span class="s2"> &quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.G0_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.K_E[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.NCE[i]}</span><span class="s2"> </span><span class="si">{s.C0_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C1_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C2_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C3_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C4_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C5_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_E[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.OMEGA_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R1_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U1_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U2_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R2_E[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.G0_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.K_S[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.NCS[i]}</span><span class="s2"> </span><span class="si">{s.C0_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C1_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C2_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C3_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C4_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C5_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_S[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.OMEGA_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R1_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U1_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U2_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R2_S[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.G0_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.K_L[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.NCL[i]}</span><span class="s2"> </span><span class="si">{s.C0_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C1_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C2_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C3_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C4_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C5_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_L[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.OMEGA_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R1_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U1_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U2_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R2_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R3[i]:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">25</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KIRD must be equal to 0,2,4 or 25&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">n</span> <span class="o">!=</span><span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">n</span> <span class="o">!=</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;n must be equal to 0 or 1 when KIRD = 0&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">Resol</span> <span class="o">!=</span><span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">Resol</span> <span class="o">!=</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;Resol must be equal to 2 or 4 when KIRD = 0&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.KIRD}</span><span class="s2">.</span><span class="si">{s.n}</span><span class="s2"> </span><span class="si">{s.Resol:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.KIRD}</span><span class="s2"> </span><span class="si">{s.Resol:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span><span class="si">{s.XPAS:.12e}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.RE:.12e}</span><span class="s2"> </span><span class="si">{s.TE:.12e}</span><span class="s2"> </span><span class="si">{s.RS:.12e}</span><span class="s2"> </span><span class="si">{s.TS:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">KPOS</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.DP:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Dodecapole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Dodecapole.html#zgoubidoo.commands.magnetique.Dodecapole">[docs]</a><span class="k">class</span> <span class="nc">Dodecapole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dodecapole magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DODECAPO&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span>
        <span class="s1">&#39;XE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;C0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;C2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XS&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        {super().__str__().rstrip()}</span>
<span class="s2">        </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">        {_cm(s.XL):.12e} {_cm(s.R0):.12e} {s.B0.to(&#39;kilogauss&#39;).magnitude:.12e}</span>
<span class="s2">        {s.XE.to(&#39;centimeter&#39;).magnitude:.12e} {s.LAM_E.to(&#39;centimeter&#39;).magnitude:.12e}</span>
<span class="s2">        6 </span><span class="si">{s.C0:.12e}</span><span class="s2"> </span><span class="si">{s.C1:.12e}</span><span class="s2"> </span><span class="si">{s.C2:.12e}</span><span class="s2"> </span><span class="si">{s.C3:.12e}</span><span class="s2"> </span><span class="si">{s.C4:.12e}</span><span class="s2"> </span><span class="si">{s.C5:.12e}</span><span class="s2"></span>
<span class="s2">        {s.XS.to(&#39;centimeter&#39;).magnitude:.12e} {s.LAM_S.to(&#39;centimeter&#39;).magnitude:.12e}</span>
<span class="s2">        6 </span><span class="si">{s.C0:.12e}</span><span class="s2"> </span><span class="si">{s.C1:.12e}</span><span class="s2"> </span><span class="si">{s.C2:.12e}</span><span class="s2"> </span><span class="si">{s.C3:.12e}</span><span class="s2"> </span><span class="si">{s.C4:.12e}</span><span class="s2"> </span><span class="si">{s.C5:.12e}</span><span class="s2"></span>
<span class="s2">        {_cm(s.XPAS)}</span>
<span class="s2">        </span><span class="si">{s.KPOS}</span><span class="s2"> {_cm(s.XCE):.12e} {_cm(s.YCE):.12e} {_radian(s.ALE):.12e}</span>
<span class="s2">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Drift"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Drift.html#zgoubidoo.commands.magnetique.Drift">[docs]</a><span class="k">class</span> <span class="nc">Drift</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Field free drift space.</span>

<span class="sd">    TODO</span>

<span class="sd">    &gt;&gt;&gt; Drift(XL=10 * _ureg.cm)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;DRIFT&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="n">COLOR</span> <span class="o">=</span> <span class="s1">&#39;yellow&#39;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        {super().__str__().rstrip()}</span>
<span class="s2">        {_cm(s.XL):.12e}</span>
<span class="s2">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Drift.plot"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Drift.html#zgoubidoo.commands.magnetique.Drift.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artist</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            artist:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">artist</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">artist</span><span class="o">.</span><span class="n">with_drifts</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">artist</span><span class="p">)</span></div>

<div class="viewcode-block" id="Drift.parse"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Drift.html#zgoubidoo.commands.magnetique.Drift.parse">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">stream</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;TODO&quot;&quot;&quot;</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &#39;</span><span class="si">{}</span><span class="s2">&#39; {label1:w}</span>
<span class="s2">        </span><span class="si">{XL_:.12e}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_parse</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">split</span><span class="p">()),</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span></div></div>


<div class="viewcode-block" id="Emma"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Emma.html#zgoubidoo.commands.magnetique.Emma">[docs]</a><span class="k">class</span> <span class="nc">Emma</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;2-D Cartesian or cylindrical mesh field map for EMMA FFAG.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;EMMA&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="FFAG"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.FFAG.html#zgoubidoo.commands.magnetique.FFAG">[docs]</a><span class="k">class</span> <span class="nc">FFAG</span><span class="p">(</span><span class="n">PolarMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FFAG magnet, N-tuple.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;FFAG&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>

            <span class="s1">&#39;ACN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;DELTA_RM&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;BZ0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;G0_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;K_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;THETA_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;R1_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;U1_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;U2_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;R2_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;G0_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;K_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;THETA_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;R1_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;U1_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;U2_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;R2_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;G0_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;K_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;NCL&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
            <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>

            <span class="s1">&#39;KIRD&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;Resol&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;DP&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        {super().__str__().rstrip()}</span>
<span class="s2">        </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{s.N}</span><span class="s2"> </span><span class="si">{s.AT:.12e}</span><span class="s2"> </span><span class="si">{s.RM:.12e}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.ACN[i]:.12e}</span><span class="s2"> </span><span class="si">{s.DELTA_RM[i]:.12e}</span><span class="s2"> </span><span class="si">{s.BZ0[i]:.12e}</span><span class="s2"> </span><span class="si">{s.K[i]:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.G0_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.K_E[i]:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.NCE[i]}</span><span class="s2"> </span><span class="si">{s.C0_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C1_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C2_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C3_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C4_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C5_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_E[i]:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.OMEGA_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R1_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U1_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U2_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R2_E[i]:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.G0_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.K_S[i]:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.NCS[i]}</span><span class="s2"> </span><span class="si">{s.C0_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C1_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C2_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C3_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C4_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C5_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_S[i]:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.OMEGA_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R1_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U1_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U2_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R2_S[i]:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.G0_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.K_L[i]:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.NCL[i]}</span><span class="s2"> </span><span class="si">{s.C0_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C1_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C2_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C3_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C4_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C5_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_L[i]:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.OMEGA_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R1_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U1_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U2_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R2_L[i]:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">25</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KIRD must be equal to 0,2,4 or 25&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">Resol</span> <span class="o">!=</span><span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">Resol</span> <span class="o">!=</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;Resol must be equal to 2 or 4 when KIRD = 0&quot;</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{s.KIRD}</span><span class="s2"> </span><span class="si">{s.Resol:.12e}</span><span class="s2"> </span>
<span class="s2">        </span><span class="si">{s.XPAS:.12e}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.RE:.12e}</span><span class="s2"> </span><span class="si">{s.TE:.12e}</span><span class="s2"> </span><span class="si">{s.RS:.12e}</span><span class="s2"> </span><span class="si">{s.TS:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.DP:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="FFAGSpirale"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.FFAGSpirale.html#zgoubidoo.commands.magnetique.FFAGSpirale">[docs]</a><span class="k">class</span> <span class="nc">FFAGSpirale</span><span class="p">(</span><span class="n">PolarMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Spiral FFAG magnet, N-tuple.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;FFAG-SPI&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RM&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>

        <span class="s1">&#39;ACN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;DELTA_RM&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;BZ0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;G0_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;K_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;SHIFT_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;OMEGA_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;XI_E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;DUMMY1_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DUMMY2_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DUMMY3_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DUMMY4_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;G0_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;K_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;SHIFT_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;OMEGA_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;XI_S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;DUMMY1_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DUMMY2_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DUMMY3_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DUMMY4_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;G0_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;K_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;NCL&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C0_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C1_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C2_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C3_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C4_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;C5_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;SHIFT_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;OMEGA_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;THETA_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;R1_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;U1_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;U2_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>
        <span class="s1">&#39;R2_L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e9</span><span class="p">,</span> <span class="p">],</span>

        <span class="s1">&#39;KIRD&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;Resol&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;RS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;DP&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            {super().__str__().rstrip()}</span>
<span class="s2">            </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.N}</span><span class="s2"> </span><span class="si">{s.AT:.12e}</span><span class="s2"> </span><span class="si">{s.RM:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.ACN[i]:.12e}</span><span class="s2"> </span><span class="si">{s.DELTA_RM[i]:.12e}</span><span class="s2"> </span><span class="si">{s.BZ0[i]:.12e}</span><span class="s2"> </span><span class="si">{s.K[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.G0_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.K_E[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.NCE[i]}</span><span class="s2"> </span><span class="si">{s.C0_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C1_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C2_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C3_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C4_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C5_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_E[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.OMEGA_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.XI_E[i]:.12e}</span><span class="s2"> </span><span class="si">{s.DUMMY1_E:.12e}</span><span class="s2"> </span><span class="si">{s.DUMMY2_E:.12e}</span><span class="s2"> </span><span class="si">{s.DUMMY3_E:.12e}</span><span class="s2"> </span><span class="si">{s.DUMMY4_E:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.G0_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.K_S[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.NCS[i]}</span><span class="s2"> </span><span class="si">{s.C0_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C1_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C2_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C3_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C4_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C5_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_S[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.OMEGA_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.XI_S[i]:.12e}</span><span class="s2"> </span><span class="si">{s.DUMMY1_S:.12e}</span><span class="s2"> </span><span class="si">{s.DUMMY2_S:.12e}</span><span class="s2"> </span><span class="si">{s.DUMMY3_S:.12e}</span><span class="s2"> </span><span class="si">{s.DUMMY4_S:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.G0_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.K_L[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.NCL[i]}</span><span class="s2"> </span><span class="si">{s.C0_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C1_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C2_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C3_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C4_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.C5_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.SHIFT_L[i]:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.OMEGA_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.THETA_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R1_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U1_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.U2_L[i]:.12e}</span><span class="s2"> </span><span class="si">{s.R2_L[i]:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">!=</span> <span class="mi">25</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KIRD must be equal to 0,2,4 or 25&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">Resol</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">KIRD</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">Resol</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;Resol must be equal to 2 or 4 when KIRD = 0&quot;</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.KIRD}</span><span class="s2"> </span><span class="si">{s.Resol:.12e}</span><span class="s2"> </span>
<span class="s2">            </span><span class="si">{s.XPAS:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RE</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">RS</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">RM</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.RE:.12e}</span><span class="s2"> </span><span class="si">{s.TE:.12e}</span><span class="s2"> </span><span class="si">{s.RS:.12e}</span><span class="s2"> </span><span class="si">{s.TS:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.DP:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Multipole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Multipole.html#zgoubidoo.commands.magnetique.Multipole">[docs]</a><span class="k">class</span> <span class="nc">Multipole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Magnetic multipole.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;MULTIPOL&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;B1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;B2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;B3&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;B4&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;B5&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;B6&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;B7&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;B8&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;B9&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;B10&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;E_2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;E_3&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;E_4&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;E_5&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;E_6&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;E_7&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;E_8&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;E_9&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;E_10&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;S_2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;S_3&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;S_4&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;S_5&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;S_6&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;S_7&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;S_8&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;S_9&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;S_10&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R3&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R4&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R5&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R6&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R7&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R8&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R9&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R10&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            {super().__str__().rstrip()}</span>
<span class="s2">            </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.XL:.12e}</span><span class="s2"> </span><span class="si">{s.R0:.12e}</span><span class="s2"> </span><span class="si">{s.B1:.12e}</span><span class="s2"> </span><span class="si">{s.B2:.12e}</span><span class="s2"> </span><span class="si">{s.B3:.12e}</span><span class="s2"> </span><span class="si">{s.B4:.12e}</span><span class="s2"> </span><span class="si">{s.B5:.12e}</span><span class="s2"> </span><span class="si">{s.B6:.12e}</span><span class="s2"> </span><span class="si">{s.B7:.12e}</span><span class="s2"> </span><span class="si">{s.B8:.12e}</span><span class="s2"> </span><span class="si">{s.B9:.12e}</span><span class="s2"> </span><span class="si">{s.B10:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.X_E:.12e}</span><span class="s2"> </span><span class="si">{s.LAM_E:.12e}</span><span class="s2"> </span><span class="si">{s.E_2:.12e}</span><span class="s2"> </span><span class="si">{s.E_3:.12e}</span><span class="s2"> </span><span class="si">{s.E_4:.12e}</span><span class="s2"> </span><span class="si">{s.E_5:.12e}</span><span class="s2"> </span><span class="si">{s.E_6:.12e}</span><span class="s2"> </span><span class="si">{s.E_7:.12e}</span><span class="s2"> </span><span class="si">{s.E_8:.12e}</span><span class="s2"> </span><span class="si">{s.E_9:.12e}</span><span class="s2"> </span><span class="si">{s.E_10:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.NCE}</span><span class="s2"> </span><span class="si">{s.C0_E:.12e}</span><span class="s2"> </span><span class="si">{s.C1_E:.12e}</span><span class="s2"> </span><span class="si">{s.C2_E:.12e}</span><span class="s2"> </span><span class="si">{s.C3_E:.12e}</span><span class="s2"> </span><span class="si">{s.C4_E:.12e}</span><span class="s2"> </span><span class="si">{s.C5_E:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.X_S:.12e}</span><span class="s2"> </span><span class="si">{s.LAM_S:.12e}</span><span class="s2"> </span><span class="si">{s.S_2:.12e}</span><span class="s2"> </span><span class="si">{s.S_3:.12e}</span><span class="s2"> </span><span class="si">{s.S_4:.12e}</span><span class="s2"> </span><span class="si">{s.S_5:.12e}</span><span class="s2"> </span><span class="si">{s.S_6:.12e}</span><span class="s2"> </span><span class="si">{s.S_7:.12e}</span><span class="s2"> </span><span class="si">{s.S_8:.12e}</span><span class="s2"> </span><span class="si">{s.S_9:.12e}</span><span class="s2"> </span><span class="si">{s.S_10:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.NCS}</span><span class="s2"> </span><span class="si">{s.C0_S:.12e}</span><span class="s2"> </span><span class="si">{s.C1_S:.12e}</span><span class="s2"> </span><span class="si">{s.C2_S:.12e}</span><span class="s2"> </span><span class="si">{s.C3_S:.12e}</span><span class="s2"> </span><span class="si">{s.C4_S:.12e}</span><span class="s2"> </span><span class="si">{s.C5_S:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.R1:.12e}</span><span class="s2"> </span><span class="si">{s.R2:.12e}</span><span class="s2"> </span><span class="si">{s.R3:.12e}</span><span class="s2"> </span><span class="si">{s.R4:.12e}</span><span class="s2"> </span><span class="si">{s.R5:.12e}</span><span class="s2"> </span><span class="si">{s.R6:.12e}</span><span class="s2"> </span><span class="si">{s.R7:.12e}</span><span class="s2"> </span><span class="si">{s.R8:.12e}</span><span class="s2"> </span><span class="si">{s.R9:.12e}</span><span class="s2"> </span><span class="si">{s.R10:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.XPAS:.12e}</span><span class="s2">  </span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1,2 or 3.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">B1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;B1 must be non-zero&quot;</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Octupole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Octupole.html#zgoubidoo.commands.magnetique.Octupole">[docs]</a><span class="k">class</span> <span class="nc">Octupole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Octupole magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;OCTUPOLE&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            {super().__str__().rstrip()}</span>
<span class="s2">            </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.XL:.12e}</span><span class="s2"> </span><span class="si">{s.R0:.12e}</span><span class="s2"> </span><span class="si">{s.B0:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.X_E:.12e}</span><span class="s2"> </span><span class="si">{s.LAM_E:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.NCE}</span><span class="s2"> </span><span class="si">{s.C0_E:.12e}</span><span class="s2"> </span><span class="si">{s.C1_E:.12e}</span><span class="s2"> </span><span class="si">{s.C2_E:.12e}</span><span class="s2"> </span><span class="si">{s.C3_E:.12e}</span><span class="s2"> </span><span class="si">{s.C4_E:.12e}</span><span class="s2"> </span><span class="si">{s.C5_E:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.X_S:.12e}</span><span class="s2"> </span><span class="si">{s.LAM_S:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.NCS}</span><span class="s2"> </span><span class="si">{s.C0_S:.12e}</span><span class="s2"> </span><span class="si">{s.C1_S:.12e}</span><span class="s2"> </span><span class="si">{s.C2_S:.12e}</span><span class="s2"> </span><span class="si">{s.C3_S:.12e}</span><span class="s2"> </span><span class="si">{s.C4_S:.12e}</span><span class="s2"> </span><span class="si">{s.C5_S:.12e}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{s.XPAS:.12e}</span><span class="s2">  </span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="PS170"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.PS170.html#zgoubidoo.commands.magnetique.PS170">[docs]</a><span class="k">class</span> <span class="nc">PS170</span><span class="p">(</span><span class="n">Magnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simulation of a round shape dipole magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &gt;&gt;&gt; PS170(&#39;PS170&#39;, IL=2, XL=2 * _ureg.m, R0 = 1.5 * _ureg.m, B0 = 1 * _ureg.tesla)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;PS170&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;print field and coordinates along trajectories&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;Length of the element&#39;</span><span class="p">),</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;, radius of the circular dipole&#39;</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">tesla</span><span class="p">,</span> <span class="s1">&#39;field&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">mm</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">),</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be in (0, 1, 2)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        {super().__str__().rstrip()}</span>
<span class="s2">        {int(s.IL):d}</span>
<span class="s2">        {_cm(s.XL):.12e} {_cm(s.R0):.12e} {_kilogauss(s.B0):.12e}</span>
<span class="s2">        {_cm(s.XPAS):.12e}  </span>
<span class="s2">        {int(s.KPOS):d} {_cm(s.XCE):.12e} {_cm(s.YCE):.12e} {_radian(s.ALE):.12e}</span>
<span class="s2">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Quadisex"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Quadisex.html#zgoubidoo.commands.magnetique.Quadisex">[docs]</a><span class="k">class</span> <span class="nc">Quadisex</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sharp edge magnetic multipoles.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;QUADISEX&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EB1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EB2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EG1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EG2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                {super().__str__().rstrip()}</span>
<span class="s2">                </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.XL:.12e}</span><span class="s2"> </span><span class="si">{s.R0:.12e}</span><span class="s2"> </span><span class="si">{s.B0:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.N:.12e}</span><span class="s2"> </span><span class="si">{s.EB1:.12e}</span><span class="s2"> </span><span class="si">{s.EB2:.12e}</span><span class="s2"> </span><span class="si">{s.EG1:.12e}</span><span class="s2"> </span><span class="si">{s.EG2:.12e}</span><span class="s2"> </span>
<span class="s2">                </span><span class="si">{s.XPAS:.12e}</span><span class="s2">  </span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Quadrupole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Quadrupole.html#zgoubidoo.commands.magnetique.Quadrupole">[docs]</a><span class="k">class</span> <span class="nc">Quadrupole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Quadrupole magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;QUADRUPO&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Print field and coordinates along trajectories&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Magnet length&#39;</span><span class="p">),</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Radius of the pole tips&#39;</span><span class="p">),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,</span> <span class="s1">&#39;Field at pole tips&#39;</span><span class="p">),</span>
        <span class="s1">&#39;XE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face integration zone for the fringe field&#39;</span><span class="p">),</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Entrance face fringe field extent&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face integration zone for the fringe field&#39;</span><span class="p">),</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Exit face fringe field extent&#39;</span><span class="p">),</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span> <span class="s1">&#39;Integration step&#39;</span><span class="p">),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        {super().__str__().rstrip()}</span>
<span class="s2">        </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">        {_cm(s.XL):.12e} {_cm(s.R0):.12e} {_kilogauss(s.B0):.12e}</span>
<span class="s2">        {_cm(s.XE):.12e} {_cm(s.LAM_E):.12e}</span>
<span class="s2">        6 </span><span class="si">{s.C0_E:.12e}</span><span class="s2"> </span><span class="si">{s.C1_E:.12e}</span><span class="s2"> </span><span class="si">{s.C2_E:.12e}</span><span class="s2"> </span><span class="si">{s.C3_E:.12e}</span><span class="s2"> </span><span class="si">{s.C4_E:.12e}</span><span class="s2"> </span><span class="si">{s.C5_E:.12e}</span><span class="s2"></span>
<span class="s2">        {_cm(s.XS):.12e} {_cm(s.LAM_S):.12e}</span>
<span class="s2">        6 </span><span class="si">{s.C0_S:.12e}</span><span class="s2"> </span><span class="si">{s.C1_S:.12e}</span><span class="s2"> </span><span class="si">{s.C2_S:.12e}</span><span class="s2"> </span><span class="si">{s.C3_S:.12e}</span><span class="s2"> </span><span class="si">{s.C4_S:.12e}</span><span class="s2"> </span><span class="si">{s.C5_S:.12e}</span><span class="s2"></span>
<span class="s2">        {_cm(s.XPAS)}</span>
<span class="s2">        </span><span class="si">{s.KPOS}</span><span class="s2"> {_cm(s.XCE):.12e} {_cm(s.YCE):.12e} {_radian(s.ALE):.12e}</span>
<span class="s2">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Quadrupolar gradient (field at pole tip divided by the bore radius.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">B0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>

    <span class="nd">@gradient</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B0</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>

<div class="viewcode-block" id="Quadrupole.align"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Quadrupole.html#zgoubidoo.commands.magnetique.Quadrupole.align">[docs]</a>    <span class="k">def</span> <span class="nf">align</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">XCE</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">YCE</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ALE</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radians</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>


<div class="viewcode-block" id="SexQuad"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.SexQuad.html#zgoubidoo.commands.magnetique.SexQuad">[docs]</a><span class="k">class</span> <span class="nc">SexQuad</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sharp edge magnetic multipole.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;SEXQUAD&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EB1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EB2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EG1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;EG2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    {super().__str__().rstrip()}</span>
<span class="s2">                    </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{s.XL:.12e}</span><span class="s2"> </span><span class="si">{s.R0:.12e}</span><span class="s2"> </span><span class="si">{s.B0:.12e}</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{s.N:.12e}</span><span class="s2"> </span><span class="si">{s.EB1:.12e}</span><span class="s2"> </span><span class="si">{s.EB2:.12e}</span><span class="s2"> </span><span class="si">{s.EG1:.12e}</span><span class="s2"> </span><span class="si">{s.EG2:.12e}</span><span class="s2"> </span>
<span class="s2">                    </span><span class="si">{s.XPAS:.12e}</span><span class="s2">  </span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="c1"># Coefficients for the calculation of B.</span>
        <span class="c1"># if Y &gt; 0 : B = EB1 and G = EG1;</span>
        <span class="c1"># if Y &lt; 0: B = EB2 and G = EG2.</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># XCE, YCE and ALE set to 0 and unused</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Elements are misaligned</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Sextupole"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Sextupole.html#zgoubidoo.commands.magnetique.Sextupole">[docs]</a><span class="k">class</span> <span class="nc">Sextupole</span><span class="p">(</span><span class="n">CartesianMagnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sextupole magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;SEXTUPOL&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;LAM_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;LAM_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NCS&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C0_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C1_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C2_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C3_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C4_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;C5_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                {super().__str__().rstrip()}</span>
<span class="s2">                </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.XL:.12e}</span><span class="s2"> </span><span class="si">{s.R0:.12e}</span><span class="s2"> </span><span class="si">{s.B0:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.X_E:.12e}</span><span class="s2"> </span><span class="si">{s.LAM_E:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.NCE}</span><span class="s2"> </span><span class="si">{s.C0_E:.12e}</span><span class="s2"> </span><span class="si">{s.C1_E:.12e}</span><span class="s2"> </span><span class="si">{s.C2_E:.12e}</span><span class="s2"> </span><span class="si">{s.C3_E:.12e}</span><span class="s2"> </span><span class="si">{s.C4_E:.12e}</span><span class="s2"> </span><span class="si">{s.C5_E:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.X_S:.12e}</span><span class="s2"> </span><span class="si">{s.LAM_S:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.NCS}</span><span class="s2"> </span><span class="si">{s.C0_S:.12e}</span><span class="s2"> </span><span class="si">{s.C1_S:.12e}</span><span class="s2"> </span><span class="si">{s.C2_S:.12e}</span><span class="s2"> </span><span class="si">{s.C3_S:.12e}</span><span class="s2"> </span><span class="si">{s.C4_S:.12e}</span><span class="s2"> </span><span class="si">{s.C5_S:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.XPAS:.12e}</span><span class="s2">  </span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># XCE, YCE and ALE set to 0 and unused</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Elements are misaligned</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Solenoid"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Solenoid.html#zgoubidoo.commands.magnetique.Solenoid">[docs]</a><span class="k">class</span> <span class="nc">Solenoid</span><span class="p">(</span><span class="n">Magnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solenoid.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;SOLENOID&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;X_E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;X_S&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                {super().__str__().rstrip()}</span>
<span class="s2">                </span><span class="si">{s.IL}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.XL:.12e}</span><span class="s2"> </span><span class="si">{s.R0:.12e}</span><span class="s2"> </span><span class="si">{s.B0:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.X_E:.12e}</span><span class="s2"> </span><span class="si">{s.X_S:.12e}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{s.XPAS:.12e}</span><span class="s2">  </span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be equal to 1 or 2&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># XCE, YCE and ALE set to 0 and unused</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">KPOS</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Elements are misaligned</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                </span><span class="si">{s.KPOS}</span><span class="s2"> </span><span class="si">{s.XCE:.12e}</span><span class="s2"> </span><span class="si">{s.YCE:.12e}</span><span class="s2"> </span><span class="si">{s.ALE:.12e}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">command</span><span class="p">))</span></div>


<div class="viewcode-block" id="Undulator"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Undulator.html#zgoubidoo.commands.magnetique.Undulator">[docs]</a><span class="k">class</span> <span class="nc">Undulator</span><span class="p">(</span><span class="n">Magnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Undulator magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;UNDULATOR&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Venus"><a class="viewcode-back" href="../../../api/zgoubidoo.commands.magnetique.Venus.html#zgoubidoo.commands.magnetique.Venus">[docs]</a><span class="k">class</span> <span class="nc">Venus</span><span class="p">(</span><span class="n">Magnet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simulation of a rectangular shaped dipole magnet.</span>

<span class="sd">    TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KEYWORD</span> <span class="o">=</span> <span class="s1">&#39;VENUS&#39;</span>
    <span class="sd">&quot;&quot;&quot;Keyword of the command used for the Zgoubi input data.&quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">),</span>
        <span class="s1">&#39;XL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,),</span>
        <span class="s1">&#39;YL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,),</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">kilogauss</span><span class="p">,),</span>
        <span class="s1">&#39;XPAS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,),</span>
        <span class="s1">&#39;KPOS&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;XCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,),</span>
        <span class="s1">&#39;YCE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">centimeter</span><span class="p">,),</span>
        <span class="s1">&#39;ALE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">_ureg</span><span class="o">.</span><span class="n">radian</span><span class="p">,),</span>
    <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Parameters of the command, with their default value, their description and optinally an index used by other </span>
<span class="sd">    commands (e.g. fit).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">KPOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_ZgoubidooException</span><span class="p">(</span><span class="s2">&quot;KPOS must be in (0, 1, 2)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        {super().__str__().rstrip()}</span>
<span class="s2">        {int(self.IL):d}</span>
<span class="s2">        {_cm(self.XL):.12e} {_cm(self.YL):.12e} {_kilogauss(self.B0):.12e}</span>
<span class="s2">        {_cm(self.XPAS):.12e}  </span>
<span class="s2">        {int(self.KPOS):d} {_cm(self.XCE):.12e} {_cm(self.YCE):.12e} {_radian(self.ALE):.12e}</span>
<span class="s2">        &quot;&quot;&quot;</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Cédric Hernalsteens (cedric.hernalsteens@iba-group.com)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>